---
title: "Activist paper preliminary output"
author: "Anya Nakhmurina"
fontsize: 12pt
linestretch: 1.5
date: "`r format(Sys.time(), '%d %B, %Y')`"
bibliography: networks.bib
output: pdf_document
header-includes: 
  - \usepackage{booktabs}
  - \usepackage{dcolumn}
  - \usepackage{caption}
  - \usepackage{fixltx2e}
  - \usepackage[flushleft]{threeparttable}
  - \usepackage{amsmath}
  - \usepackage{graphics}
  - \usepackage{float}
  - \usepackage{longtable}
  - \usepackage{array}
  - \usepackage{rotating}
  - \usepackage{float}
---


\section{The purpose of this document}

The research question of this paper is to learn whether there are any network effects among the 'active' and 'passive' activist investors over the span of the activists' campaign. This document contains a summary of my progress with this project. Research approach section is basically copied from my original proposal to remind the reader about my research approach. 



```{r, message=F, warning=F, echo=FALSE,  fig.width=14, fig.height=6, }
suppressWarnings(library("xtable"))

library(dplyr)
library(xtable)
library(dplyr)
library(plyr)
library(ggplot2)
library(lmtest)
library(gridExtra)
library(reshape)
library(reshape2)
library(gridExtra)
library(Hmisc)
library(sfsmisc)
library(gdata)
library(scales)
library(xtable)
library(tables)

'%!in%' <- function(x,y)!('%in%'(x,y))

setwd("~/Networks/Analysis")
final.output <- ("C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown")

#################
# Create summary table for the merged subsample


classified <- read.csv("classified.2015.csv")
classified$announce_date <- as.Date(classified$announce_date, "%m/%d/%Y")
classified.2015 <- classified[(classified$announce_date< "2016-1-1"),]
classified.2015 <- classified.2015[, -1]
load("shark.sub.all")

cl <- shark.sub.all[ c(names(classified.2015)) ]

cl_all = rbind(cl, classified.2015)

classified.2015 = cl_all

sum.table <- data.frame()

gen.under = classified.2015[which(classified.2015$activist_objective_1 == "General undervaluation/maximize shareholder value"),]
general.undervaluation <- cbind("General undervaluation/maximize shareholder value" , nrow(gen.under), percent( nrow(gen.under)/nrow(classified.2015) ), "NA" ) 
sum.table = rbind (sum.table, general.undervaluation)
names(sum.table) = c("objective", "total.number", "percentage", "success.rate")

obj.list = unique(classified.2015$activist_objective_1) 

# include everything but General undervaluation  and public short position in the list

ol = c( "Excess cash, under-leverage, dividends/repurchases", "Equity issuance, restructure debt, recapitalization",
       "Operational efficiency", "Lack of focus, business restructuring and spinning off", "M&A: as target (against the deal/for better terms)",
       "M&A: as acquirer (against the deal/for better terms)", "Pursue growth strategies", "Sell company or main assets to a third party", 
       "Take control/buyout company and/or take it private", "Rescind takeover defenses", "Oust CEO, chairman", "Board independence and fair representation",
       "More information disclosure/potential fraud", "Excess executive compensation/pay for performance","Institute enviromental protection policy")

sum.table2 = data.frame()

for( objective in ol ){
  
  # print(objective)

ex.cash = classified.2015[which(classified.2015$activist_objective_1 == objective | classified.2015$activist_objective_2 == objective | classified.2015$activist_objective_3 == objective),]

suc = ex.cash[which(ex.cash$success_objective_1 %in% c("Success", "Partial") & ex.cash$activist_objective_1 == objective | ex.cash$success_objective_2 %in% c("Success", "Partial") & ex.cash$activist_objective_2 == objective  | ex.cash$success_objective_3 %in% c("Success", "Partial") & ex.cash$activist_objective_3 == objective ),]

total.number = nrow(ex.cash)
success.rate <- percent(nrow(suc)/nrow(ex.cash))
percentage <- percent( nrow(ex.cash)/nrow(classified.2015) )

output <- cbind(objective , total.number, percentage , success.rate )

sum.table2 <- rbind(sum.table2, output)
}


non.gen.under = classified.2015[which(classified.2015$activist_objective_1 %!in% c("General undervaluation/maximize shareholder value") ),]
total.number_all <- nrow(non.gen.under)
percentage_all <- percent(total.number_all/nrow(classified.2015))
suc = non.gen.under[which(non.gen.under$success_objective_1 %in% c("Success", "Partial") | non.gen.under$success_objective_2 %in% c("Success", "Partial")  | non.gen.under$success_objective_3 %in% c("Success", "Partial")  ),]
success_all = percent( nrow(suc)/nrow(non.gen.under))
sum = as.data.frame ( cbind( "Sum of categories not falling into general undervaluation", total.number_all, percentage_all, success_all) )
names(sum) = names(sum.table2)

sum_bear <- data.frame()
bear = classified.2015[which(classified.2015$activist_objective_1 ==  "Public Short Position/Bear Raid"),]
bear_short <- cbind("Public Short Position/Bear Raid" , nrow(bear), percent( nrow(bear)/nrow(classified.2015) ), "NA" ) 
sum_bear = rbind (sum_bear, bear_short)
names(sum_bear) = c("objective", "total.number", "percentage", "success.rate")


sum.table2 = rbind(sum.table2, sum_bear)
sum.table2 = rbind(sum.table2, sum)
sum.table = rbind(sum.table, sum.table2)

sum.table<-as.data.frame(sum.table)
sum.table_tex <- xtable(sum.table,include.rownames=TRUE, digits=1)

print(sum.table_tex,
      only.contents=TRUE,
      include.rownames=FALSE,
      include.colnames = FALSE,
      type="latex",

      floating = FALSE,
      hline.after = NULL, comment = FALSE,
      file="C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/sum_table_tex.tex")



# Creat summary table after merge

load("short.data.compust_2000_2015")
classified_merged = short.data.compust

sum.table <- data.frame()

gen.under = classified_merged[which(classified_merged$activist_objective_1 == "General undervaluation/maximize shareholder value"),]
general.undervaluation <- cbind("General undervaluation/maximize shareholder value" , nrow(gen.under),   percent(nrow(gen.under)/nrow(classified_merged) ), "NA" ) 
sum.table = rbind (sum.table, general.undervaluation)
names(sum.table) = c("objective", "total.number", "percentage", "success.rate")

obj.list = unique(classified_merged$activist_objective_1) 

# include everything but General undervaluation in the list

ol = c( "Excess cash, under-leverage, dividends/repurchases", "Equity issuance, restructure debt, recapitalization",
       "Operational efficiency", "Lack of focus, business restructuring and spinning off", "M&A: as target (against the deal/for better terms)",
       "M&A: as acquirer (against the deal/for better terms)", "Pursue growth strategies", "Sell company or main assets to a third party", 
       "Take control/buyout company and/or take it private", "Rescind takeover defenses", "Oust CEO, chairman", "Board independence and fair representation",
       "More information disclosure/potential fraud", "Excess executive compensation/pay for performance","Institute enviromental protection policy")

sum.table2 = data.frame()

for( objective in ol ){
  
ex.cash = classified_merged[which(classified_merged$activist_objective_1 == objective | classified_merged$activist_objective_2 == objective | classified_merged$activist_objective_3 == objective),]

suc = ex.cash[which(ex.cash$success_objective_1 %in% c("Success", "Partial") & ex.cash$activist_objective_1 == objective | ex.cash$success_objective_2 %in% c("Success", "Partial") & ex.cash$activist_objective_2 == objective  | ex.cash$success_objective_3 %in% c("Success", "Partial") & ex.cash$activist_objective_3 == objective ),]

total.number = nrow(ex.cash)
success.rate <- percent(nrow(suc)/nrow(ex.cash))
percentage <- percent( nrow(ex.cash)/nrow(classified_merged) )

output <- cbind(objective , total.number, percentage , success.rate )

sum.table2 <- rbind(sum.table2, output)
}

non.gen.under = classified_merged[which(classified_merged$activist_objective_1 != "General undervaluation/maximize shareholder value"),]
total.number_all <- nrow(non.gen.under)
percentage_all <- percent(total.number_all/nrow(classified_merged))
suc = non.gen.under[which(non.gen.under$success_objective_1 %in% c("Success", "Partial") | non.gen.under$success_objective_2 %in% c("Success", "Partial")  | non.gen.under$success_objective_3 %in% c("Success", "Partial")  ),]
success_all = percent( nrow(suc)/nrow(non.gen.under))
sum = as.data.frame ( cbind( "Sum of categories not falling into general undervaluation", total.number_all, percentage_all, success_all) )
names(sum) = names(sum.table2)

sum_bear <- data.frame()
bear = classified.2015[which(classified.2015$activist_objective_1 ==  "Public Short Position/Bear Raid"),]
bear_short <- cbind("Public Short Position/Bear Raid" , nrow(bear), percent( nrow(bear)/nrow(classified.2015) ), "NA" ) 
sum_bear = rbind (sum_bear, bear_short)
names(sum_bear) = c("objective", "total.number", "percentage", "success.rate")


sum.table2 = rbind(sum.table2, sum_bear)
sum.table2 = rbind(sum.table2, sum)
sum.table = rbind(sum.table, sum.table2)

sum.table<-as.data.frame(sum.table)
sum.table_tex_short <- xtable(sum.table,include.rownames=TRUE, digits=1)

print(sum.table_tex_short,
      only.contents=TRUE,
      include.rownames=FALSE,
      include.colnames = FALSE,
      type="latex",

      floating = FALSE,
      hline.after = NULL, comment = FALSE,
      file="C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/sum.table_tex_short.tex")

###############
# Campaigns by type 

load("shark.sub.all.2015")

dem = shark.sub.all.2015[which(shark.sub.all.2015$exit_stage == "demand_negot"),]
demand_negot_count = nrow(dem)
dem_negot_percent = percent( demand_negot_count/nrow(shark.sub.all.2015))
dem_suc = dem[which(dem$success_objective_1 %in% c("Success", "Partial") | dem$success_objective_2 %in% c("Success", "Partial")  | dem$success_objective_3 %in% c("Success", "Partial") ),]
dem_success_number = nrow(dem_suc)
dem_success_percent = percent(dem_success_number/nrow(dem))
demand_negotiations = cbind("Demand negotiations", demand_negot_count, dem_negot_percent,dem_success_number, dem_success_percent)

brep = shark.sub.all.2015[which(shark.sub.all.2015$exit_stage == "board_repres"),]
board_rep_count = nrow(brep)
board_rep_percent = percent( board_rep_count/nrow(shark.sub.all.2015))
brep_suc = brep[which(brep$success_objective_1 %in% c("Success", "Partial") | brep$success_objective_2 %in% c("Success", "Partial")  | brep$success_objective_3 %in% c("Success", "Partial") ),]
brep_success_number = nrow(brep_suc)
brep_success_percent = percent(brep_success_number/nrow(brep))
board_representation = cbind("Board representation", board_rep_count, board_rep_percent,brep_success_number, brep_success_percent)

pfight = shark.sub.all.2015[which(shark.sub.all.2015$exit_stage == "proxy_fight"),]
pfight_count = nrow(pfight)
pfight_percent = percent( pfight_count/nrow(shark.sub.all.2015))
pfight_suc = pfight[which(pfight$success_objective_1 %in% c("Success", "Partial") | pfight$success_objective_2 %in% c("Success", "Partial")  | pfight$success_objective_3 %in% c("Success", "Partial") ),]
pfight_success_number = nrow(pfight_suc)
pfight_success_percent = percent(pfight_success_number/nrow(pfight))
proxy_fight = cbind("Proxy fight", pfight_count, pfight_percent,pfight_success_number, pfight_success_percent)

thpfight = shark.sub.all.2015[which(shark.sub.all.2015$exit_stage == "treaten_fight"),]
thpfight_count = nrow(thpfight)
thpfight_percent = percent( thpfight_count/nrow(shark.sub.all.2015))
thpfight_suc = thpfight[which(thpfight$success_objective_1 %in% c("Success", "Partial") | thpfight$success_objective_2 %in% c("Success", "Partial")  | thpfight$success_objective_3 %in% c("Success", "Partial") ),]
thpfight_success_number = nrow(thpfight_suc)
thpfight_success_percent = percent(thpfight_success_number/nrow(thpfight))
treaten_proxy_fight = cbind("Threaten proxy fight", thpfight_count, thpfight_percent,thpfight_success_number, thpfight_success_percent)

buyc = shark.sub.all.2015[which(shark.sub.all.2015$exit_stage == "buy_company"),]
buyc_count = nrow(buyc)
buyc_percent = percent( buyc_count/nrow(shark.sub.all.2015))
buyc_suc = buyc[which(buyc$success_objective_1 %in% c("Success", "Partial") | buyc$success_objective_2 %in% c("Success", "Partial")  | buyc$success_objective_3 %in% c("Success", "Partial") ),]
buyc_success_number = nrow(buyc_suc)
buyc_success_percent = percent(buyc_success_number/nrow(buyc))
buy_company = cbind("Buy company", buyc_count, buyc_percent,buyc_success_number, buyc_success_percent)

# success_stage_all = rbind(demand_negotiations,board_representation,treaten_proxy_fight, proxy_fight, buy_company)
success_stage_all = rbind(demand_negotiations,board_representation,proxy_fight)
success_stage_all<-as.data.frame(success_stage_all)
success_stage_all_tex <- xtable(success_stage_all,include.rownames=TRUE, digits=2)

print(success_stage_all_tex,
      only.contents=TRUE,
      include.rownames=FALSE,
      include.colnames = FALSE,
      type="latex",

      floating = FALSE,
      hline.after = NULL, comment = FALSE,
      file="C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/success_stage_all_tex.tex")

####################
# Success rates by  merged data
load("short.data.compust_2000_2015")

dem = short.data.compust[which(short.data.compust$exit_stage == "demand_negot"),]
demand_negot_count = nrow(dem)
dem_negot_percent = percent( demand_negot_count/nrow(short.data.compust))
dem_suc = dem[which(dem$success_objective_1 %in% c("Success", "Partial") | dem$success_objective_2 %in% c("Success", "Partial")  | dem$success_objective_3 %in% c("Success", "Partial") ),]
dem_success_number = nrow(dem_suc)
dem_success_percent = percent(dem_success_number/nrow(dem))
demand_negotiations = cbind("Demand negotiations", demand_negot_count, dem_negot_percent,dem_success_number, dem_success_percent)

brep = short.data.compust[which(short.data.compust$exit_stage == "board_repres"),]
board_rep_count = nrow(brep)
board_rep_percent = percent( board_rep_count/nrow(short.data.compust))
brep_suc = brep[which(brep$success_objective_1 %in% c("Success", "Partial") | brep$success_objective_2 %in% c("Success", "Partial")  | brep$success_objective_3 %in% c("Success", "Partial") ),]
brep_success_number = nrow(brep_suc)
brep_success_percent = percent(brep_success_number/nrow(brep))
board_representation = cbind("Board representation", board_rep_count, board_rep_percent,brep_success_number, brep_success_percent)

pfight = short.data.compust[which(short.data.compust$exit_stage == "proxy_fight"),]
pfight_count = nrow(pfight)
pfight_percent = percent( pfight_count/nrow(short.data.compust))
pfight_suc = pfight[which(pfight$success_objective_1 %in% c("Success", "Partial") | pfight$success_objective_2 %in% c("Success", "Partial")  | pfight$success_objective_3 %in% c("Success", "Partial") ),]
pfight_success_number = nrow(pfight_suc)
pfight_success_percent = percent(pfight_success_number/nrow(pfight))
proxy_fight = cbind("Proxy fight", pfight_count, pfight_percent,pfight_success_number, pfight_success_percent)

thpfight = short.data.compust[which(short.data.compust$exit_stage == "treaten_fight"),]
thpfight_count = nrow(thpfight)
thpfight_percent = percent( thpfight_count/nrow(short.data.compust))
thpfight_suc = thpfight[which(thpfight$success_objective_1 %in% c("Success", "Partial") | thpfight$success_objective_2 %in% c("Success", "Partial")  | thpfight$success_objective_3 %in% c("Success", "Partial") ),]
thpfight_success_number = nrow(thpfight_suc)
thpfight_success_percent = percent(thpfight_success_number/nrow(thpfight))
treaten_proxy_fight = cbind("Threaten proxy fight", thpfight_count, thpfight_percent,thpfight_success_number, thpfight_success_percent)

buyc = short.data.compust[which(short.data.compust$exit_stage == "buy_company"),]
buyc_count = nrow(buyc)
buyc_percent = percent( buyc_count/nrow(short.data.compust))
buyc_suc = buyc[which(buyc$success_objective_1 %in% c("Success", "Partial") | buyc$success_objective_2 %in% c("Success", "Partial")  | buyc$success_objective_3 %in% c("Success", "Partial") ),]
buyc_success_number = nrow(buyc_suc)
buyc_success_percent = percent(buyc_success_number/nrow(buyc))
buy_company = cbind("Buy company", buyc_count, buyc_percent,buyc_success_number, buyc_success_percent)

# success_stage_merged = rbind(demand_negotiations,board_representation,treaten_proxy_fight, proxy_fight, buy_company)
success_stage_merged = rbind(demand_negotiations,board_representation, proxy_fight)
success_stage_merged = as.data.frame(success_stage_merged )
success_stage_merged_tex <- xtable(success_stage_merged ,include.rownames=TRUE, digits=2)

print(success_stage_merged_tex,
      only.contents=TRUE,
      include.rownames=FALSE,
      include.colnames = FALSE,
      type="latex",

      floating = FALSE,
      hline.after = NULL, comment = FALSE,
      file="C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/success_stage_merged_tex.tex")


#############################################################
#Create summary table for final subsample

load("short.data.compust_2000_2015")

short.summary <- data.frame()

checked_board_seats_won = short.data.compust$checked_board_seats_won
won_board_ind = short.data.compust$won_board_ind
success_of_stated_obj = short.data.compust$success_of_stated_obj
sales_growth = short.data.compust$sales_growth
oper_profit_growth = short.data.compust$oper_profit_growth

campaign_outcomes <- list(checked_board_seats_won,won_board_ind,
                       success_of_stated_obj, sales_growth, oper_profit_growth)  
names_campaign_outcomes <- c("checked_board_seats_won","won_board_ind",
                       "success_of_stated_obj", "sales_growth", "oper_profit_growth")  

for (i in 1:length(campaign_outcomes) ){
  variable = (campaign_outcomes)[[i]]
  name = names_campaign_outcomes[i]
out <- cbind( mean(variable, na.rm = TRUE),sd(variable, na.rm = TRUE), min(variable, na.rm = TRUE), quantile(variable, 0.25, na.rm = TRUE), 
                 median(variable, na.rm = TRUE), quantile(variable, 0.75, na.rm = TRUE),max(variable, na.rm = TRUE))
out <- round(out, 2)
out = cbind("campaign outcome",name,out)
short.summary = rbind(short.summary, out)}

active.activist.size=short.data.compust$active.activist.size

name = "log(active.activist.size)"
out_persuasiveness <- cbind ( mean(log(short.data.compust$active.activist.size), na.rm = TRUE),
                              sd(log(short.data.compust$active.activist.size), na.rm = TRUE), 
                              min(log(short.data.compust$active.activist.size), na.rm = TRUE),
                              quantile(log(short.data.compust$active.activist.size), 0.25, na.rm = TRUE),
                              median(log(short.data.compust$active.activist.size), na.rm = TRUE),
                              quantile(log(short.data.compust$active.activist.size), 0.75, na.rm = TRUE),
                              max(log(short.data.compust$active.activist.size), na.rm = TRUE)) 
out_persuasiveness = round(out_persuasiveness, 2)
out_persuasiveness = cbind("activists' persuasiveness", name,out_persuasiveness)
names(out_persuasiveness) = names(short.summary)

short.summary = rbind(short.summary, out_persuasiveness)

netw <- short.data.compust[c("investor.number", "total.activist.number")]
names_netw <- names(netw)
for (i in 1:length(netw) ){
  variable = (netw)[[i]]
  name = names_netw[i]
out <- cbind( mean(variable, na.rm = TRUE),sd(variable, na.rm = TRUE), min(variable, na.rm = TRUE), quantile(variable, 0.25, na.rm = TRUE), 
                 median(variable, na.rm = TRUE), quantile(variable, 0.75, na.rm = TRUE),max(variable, na.rm = TRUE))
out = round(out, 2)
out = cbind("network variable", name, out)
short.summary = rbind(short.summary, out)}

netw_log <- short.data.compust[c("activist.size.vweighted", "activist.size.average", "inv_size_nw_s", "inv_size_nw_spr",
                                 "act_size_nw_s","act_size_nw_spr")]
names_netw_log <- c("log(activist.size.vweighted)", "log(activist.size.average)", "log(inv_size_nw_s)", "log(inv_size_nw_spr)",
                                 "log(act_size_nw_s)","log(act_size_nw_spr)")

for (i in 1:length(netw_log) ){
  variable = (netw_log)[[i]]
  name = names_netw_log[i]
  variable=log(variable)
  # print(i)
  if(sum(variable==-Inf) >0){
    variable[variable==-Inf] = 0
  }
out <- cbind( mean(variable, na.rm = TRUE),sd(variable, na.rm = TRUE), min(variable, na.rm = TRUE), quantile(variable, 0.25, na.rm = TRUE), 
                 median(variable, na.rm = TRUE), quantile(variable, 0.75, na.rm = TRUE),max(variable, na.rm = TRUE))
out = round(out, 2)
out = cbind("network variable", name, out)
short.summary = rbind(short.summary, out)}

netw_centr <- short.data.compust[c("act_s_clos", "oth_s_clos",
                                 "act_s_betw", "oth_s_betw")]
names_netw_centr <- names(netw_centr)
for (i in 1:length(netw_centr) ){
  variable = (netw_centr)[[i]]
  name = names_netw_centr[i]
out <- cbind( mean(variable, na.rm = TRUE),sd(variable, na.rm = TRUE), min(variable, na.rm = TRUE), quantile(variable, 0.25, na.rm = TRUE), 
                 median(variable, na.rm = TRUE), quantile(variable, 0.75, na.rm = TRUE),max(variable, na.rm = TRUE))
out = round(out, 2)
out = cbind("network variable", name, out)
short.summary = rbind(short.summary, out)}



load("fund_networks_summary_all")
networks_summary_all = cbind("network variable", fund_networks_summary_all )
names(networks_summary_all) = names(short.summary) 
short.summary = rbind(short.summary, networks_summary_all)

load("investor_networks_summary_all")
networks_summary_all = cbind("network variable", investor_networks_summary_all )
names(networks_summary_all) = names(short.summary) 
short.summary = rbind(short.summary, networks_summary_all)


controls = short.data.compust[c("size")]

name_controls = c("log(size)")

for (i in 1:length(controls) ){
  variable = (controls)[[i]]
  name = name_controls[i]
out <- cbind( mean(log(variable), na.rm = TRUE), sd(log(variable), na.rm = TRUE),
              min(log(variable), na.rm = TRUE), 
              quantile(log(variable), 0.25, na.rm = TRUE),
              median(log(variable), na.rm = TRUE), 
              quantile(log(variable), 0.75, na.rm = TRUE),
              max(log(variable), na.rm = TRUE))
out =round(out, 2)
out = cbind( "control variable", name, out)
short.summary = rbind(short.summary, out)}


controls = short.data.compust[c("age","leverage","mtb","oper_profit","roa","tobins_q",
                                "asset_turnover","rd_to_assets","revtq","age_activist"  )]

name_controls = names(controls)

for (i in 1:length(controls) ){
  variable = (controls)[[i]]
  name = name_controls[i]
out <- cbind( mean(variable, na.rm = TRUE),sd(variable, na.rm = TRUE), min(variable, na.rm = TRUE), quantile(variable, 0.25, na.rm = TRUE), 
                 median(variable, na.rm = TRUE), quantile(variable, 0.75, na.rm = TRUE),max(variable, na.rm = TRUE))
out =round(out, 2)
out = cbind( "control variable", name, out)
short.summary = rbind(short.summary, out)}

names(short.summary) = c("Variable type", "Variable", "Mean", "Median", "Sd")
row.names(short.summary) <- NULL
short.summary <- as.data.frame( short.summary)
names(short.summary) <- c("Variable type", "Variable", "min","25%","Mean", "Median", "75%", "max", "Sd")


short.summary<-as.data.frame(short.summary)
short_summary_tex <- xtable(short.summary,include.rownames=TRUE, digits=2)

print(short_summary_tex,
      only.contents=TRUE,
      include.rownames=FALSE,
      include.colnames = FALSE,
      type="latex",

      floating = FALSE,
      hline.after = NULL, comment = FALSE,
      file="C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/short_summary_tex.tex")


#############
# Do a correlation table

cortable= data.frame( cbind(checked_board_seats_won,won_board_ind,success_of_stated_obj,sales_growth,oper_profit_growth,log(active.activist.size)))
names(cortable)=c("checked_board_seats_won","won_board_ind","success_of_stated_obj","sales_growth","oper_profit_growth","log(active.activist.size)")

cortable2 <- short.data.compust[c("investor.number", "total.activist.number", "activist.size.vweighted",  "activist.size.average","age","leverage","size","mtb","oper_profit","roa","tobins_q","asset_turnover","rd_to_assets","revtq","saleq" )]

cortable2$'log(activist.size.vweighted)' = log(cortable2$activist.size.vweighted)
cortable2$'log(activist.size.average)' = log(cortable2$activist.size.average)
cortable2$'log(size)' = log(cortable2$size)

cortable2 = cortable2[c("investor.number", "total.activist.number", "log(activist.size.vweighted)",  "log(activist.size.average)","age","leverage","log(size)","mtb","oper_profit","roa","tobins_q","asset_turnover","rd_to_assets","revtq","saleq" )]

cortable =cbind(cortable, cortable2)

upper=round( cor(cortable, use="pairwise.complete.obs"), 2)
upper[upper.tri(upper)]<-""

upper<-as.data.frame(upper)
names(upper) <- c(1:nrow(upper))
rownames(upper) = paste0(1:nrow(upper)," ", rownames(upper))
upper_tex <- xtable(upper,include.rownames=TRUE, digits=2)

print(upper_tex,
      only.contents=TRUE,
      include.rownames=TRUE,
      include.colnames = TRUE,
      type="latex",

      floating = FALSE,
      hline.after = NULL, comment = FALSE,
      file="C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/upper_tex.tex")
```

\footnotesize
\singlespacing

\begin{center}
  \begin{longtable}{p{9cm} p{2cm} p{2cm}p{2cm} }
		\caption{ \footnotesize \textbf{Summary of events by hedge fund stated goals - the whole 2015.} The sample consists of 467 activist campaigns in 2015, of which 352 contain demands.} \\
		 \hline 
				 \multicolumn{1}{l}{Activist' Objective} & \multicolumn{1}{l}{Num. of events} & \multicolumn{1}{l}{\% of Sample}  & \multicolumn{1}{l}{\% of Success} \\
		\hline \hline 
	\input{"C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/sum_table_tex.tex"}
	\hline \hline
   \end{longtable}
\end{center}


\begin{center}
  \begin{longtable}{p{9cm} p{2cm} p{2cm}p{2cm} }
		\caption{\footnotesize  \textbf{Summary of events by hedge fund stated goals - the merged subsample of 2015.} The sample consists of 104 activist campaigns in 2015, of which 104 contain demands. The campaigns that fall into general undervaluation category are not considered here.} \\
		 \hline 
				 \multicolumn{1}{l}{Activist' Objective} & \multicolumn{1}{l}{Num. of events} & \multicolumn{1}{l}{\% of Sample}  & \multicolumn{1}{l}{\% of Success} \\
		\hline \hline 
	\input{"C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/sum.table_tex_short.tex"}
	\hline \hline
   \end{longtable}
\end{center}


\begin{center}
  \begin{longtable}{p{5cm} p{2cm} p{2cm}p{2cm}p{2cm} }
		\caption{\footnotesize \textbf{Sussess rate by stage - the merged subsample.}  This table provides the breakdown of stages at which the campaign is terminated. The table is based on the observations that are left after the campaigns data is merged with 13F data. The data on campaign avalability comes from SharkWatch database. Campaigns were manually classified. } \\
		 \hline \\[0.2ex]
\multicolumn{1}{l}{Exit after} & \multicolumn{1}{l}{Num. of campaigns} & \multicolumn{1}{l}{\% of Sample} & \multicolumn{1}{l}{Number of Successes} & \multicolumn{1}{l}{\% of Successes} \\
		\hline \hline 
	\input{"C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/success_stage_merged_tex.tex"}
	\hline \hline
   \end{longtable}
\end{center}

\pagebreak
\begin{center}\scriptsize
  \begin{longtable}{p{2.8cm} p{3.7cm} p{1.1cm}p{1cm}p{1cm}p{1cm}p{1cm}p{1cm}p{1cm} }
		\caption{\footnotesize  \textbf{Descriptive statistics.} This table provides summary statistics on the variables used in preliminary analysis. The variables are grouped by type. \textit{won\_brep\_percent} is the percentage of board seats won out of the number of activists' nominees. \textit{won\_brep\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\textit{success\_of\_stated\_obj} is an indicator of fulfillment of activists' demands. \textit{sales\_growth} is the growth of sales over the span of the campaign. \textit{oper\_profit\_growth} is an operational profitability growth over the span of the campaign. Operational profitability is defined as in  Ball et. al (2016). \textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings. \textit{investor.number} is a total number of institutional investors that hold shares of a company. \textit{total.activist.number} is the number of passive activist investors that hold shares of the company. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \textit{activist.size.vweghted} is the sum of all the company's activists' assets weighted by the share of investments in the company. \textit{activist.size.average} is an average of total assets of company's activists. \textit{spring measure} corresponds to the edges of Spring Network, which is described above. \textit{number of connections} corresponds to Number of Connections Network, where the weight of the edge is number of connections between two activists. \textit{size} is the market value of the company. \textit{age} is the age of the company. \textit{leverage} is the leverage of the company. \textit{mtb} is the market-to-book ratio of the company. \textit{oper\_profit} is an operating profitability of the company. \textit{roa} is return on company's assets. \textit{tobins\_q} is the company's Tobin's Q. \textit{asset\_turnover} is the company's asset turnover. \textit{rd\_to\_assets} is a share of R\&D expenditures to the company's assets. \textit{revtq} is the  quartely revenue, and \textit{saleq} are the company's sales. } \\
		\hline \hline 
		 \multicolumn{1}{l}{Variable type} & \multicolumn{1}{l}{Variable} & \multicolumn{1}{l}{mean}  & \multicolumn{1}{l}{sd} & \multicolumn{1}{l}{min} & \multicolumn{1}{l}{p25}& \multicolumn{1}{l}{median} & \multicolumn{1}{l}{p75} & \multicolumn{1}{l}{max}\\ \hline \\[0.2ex]
	\input{"C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/short_summary_tex.tex"}
	\hline \hline
   \end{longtable}
\end{center}

\fontsize{10}{10}\selectfont
\begin{center}
\begin{sidewaystable}[p]\scriptsize
		\caption{\footnotesize \textbf{Correlation table.} \textit{won\_brep\_percent} is the percentage of board seats won out of the number of activists' nominees. \textit{won\_brep\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\textit{success\_of\_stated\_obj} is an indicator of fulfillment of activists' demands. \textit{sales\_growth} is the growth of sales over the span of the campaign. \textit{oper\_profit\_growth} is an operational profitability growth over the span of the campaign. Operational profitability is defined as in  Ball et. al (2016). \textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings. \textit{investor.number} is a total number of institutional investors that hold shares of a company. \textit{total.activist.number} is the number of passive activist investors that hold shares of the company. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \textit{activist.size.vweghted} is the sum of all the company's activists' assets weighted by the share of investments in the company. \textit{activist.size.average} is an average of total assets of company's activists. \textit{spring measure} corresponds to the edges of Spring Network, which is described above. \textit{number of connections} corresponds to Number of Connections Network, where the weight of the edge is number of connections between two activists. \textit{size} is the market value of the company. \textit{age} is the age of the company. \textit{leverage} is the leverage of the company. \textit{mtb} is the market-to-book ratio of the company. \textit{oper\_profit} is an operating profitability of the company. \textit{roa} is return on company's assets. \textit{tobins\_q} is the company's Tobin's Q. \textit{asset\_turnover} is the company's asset turnover. \textit{rd\_to\_assets} is a share of R\&D expenditures to the company's assets. \textit{revtq} is the  quartely revenue, and \textit{saleq} are the company's sales}\centering \tiny
\begin{tabular}{p{3.4cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}}
\hline\hline
	\input{"C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/upper_tex.tex"}
	\hline\hline
\end{tabular}
\end{sidewaystable}
\end{center}

\pagebreak
 \section{Preliminary results}
 
 This section contains the tables with output of some preliminary OLS regressions. 

```{r star, results = 'asis', warning=FALSE, message=FALSE,echo=FALSE}
# ----------------------------- !Regressions are done here!---------------------

library(stargazer, quietly = TRUE)
library(sandwich, quietly = TRUE)
library(multiwayvcov, quietly= TRUE)
library(lfe, quietly = TRUE)
setwd("~/Networks/Analysis")

load("short.data.compust_2000_2015")

log1b_1 <- glm(won_board_ind ~(total.activist.number), data = short.data.compust, family = "binomial")
# re_log1b_1   <- sqrt(diag( vcovHC(log1b_1)))
re_log1b_1  = sqrt(diag(  cluster.vcov(log1b_1, short.data.compust$type1) ) )

log1b_2 <- glm(won_board_ind ~(top20_number), data = short.data.compust, family = "binomial")
# re_log1b_2   <- sqrt(diag( vcovHC(log1b_2)))
re_log1b_2  = sqrt(diag(  cluster.vcov(log1b_2, short.data.compust$type1) ) )

log1b_3 <- glm(won_board_ind ~(total.activist.number)+log(active.activist.share), data = short.data.compust, family = "binomial")
# re_log1b_3   <- sqrt(diag( vcovHC(log1b_3)))
re_log1b_3  = sqrt(diag(  cluster.vcov(log1b_3, short.data.compust$type1) ) )

log1b_4 <- glm(won_board_ind ~(top20_number)+log(active.activist.share), data = short.data.compust, family = "binomial")
# re_log1b_4   <- sqrt(diag( vcovHC(log1b_4)))
re_log1b_4  = sqrt(diag(  cluster.vcov(log1b_4, short.data.compust$type1) ) )

log1b_5 <- glm(won_board_ind ~(total.activist.number)+exit_s_board+exit_s_proxy, data = short.data.compust, family = "binomial")
# re_log1b_5  <- sqrt(diag( vcovHC(log1b_5)))
re_log1b_5  = sqrt(diag(  cluster.vcov(log1b_5, short.data.compust$type1) ) )

log1b_6 <- glm(won_board_ind ~ (total.activist.number)+exit_s_board+exit_s_proxy+log(active.activist.share)+log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy, data = short.data.compust, family = "binomial")
# re_log1b_6    <- sqrt(diag( vcovHC(log1b_6)))
re_log1b_6  = sqrt(diag(  cluster.vcov(log1b_6, short.data.compust$type1) ) )

log1b_7 <- glm(won_board_ind ~ (top20_number)+exit_s_board+exit_s_proxy, data = short.data.compust, family = "binomial")
# re_log1b_7    <- sqrt(diag(vcovHC(log1b_7) ))
re_log1b_7  = sqrt(diag(  cluster.vcov(log1b_7, short.data.compust$type1) ) )

log1b_8 <- glm(won_board_ind ~ log(active.activist.share)+(top20_number)+exit_s_board+exit_s_proxy, data = short.data.compust, family = "binomial")
# re_log1b_8    <- sqrt(diag(vcovHC(log1b_8) ))
re_log1b_8  = sqrt(diag(  cluster.vcov(log1b_8, short.data.compust$type1) ) )

log1s_1 <- glm(success_of_stated_obj ~(total.activist.number), data = short.data.compust, family = "binomial")
# re_log1s_1  <- sqrt(diag( vcovHC(log1s_1)))
re_log1s_1  = sqrt(diag(  cluster.vcov(log1s_1, short.data.compust$type1) ) )


log1s_2 <- glm(success_of_stated_obj ~(top20_number), data = short.data.compust, family = "binomial")
# re_log1s_2  <- sqrt(diag( vcovHC(log1s_2)))
re_log1s_2  = sqrt(diag(  cluster.vcov(log1s_2, short.data.compust$type1) ) )


log1s_3 <- glm(success_of_stated_obj ~(total.activist.number)+log(active.activist.share), data = short.data.compust, family = "binomial")
# re_log1s_3  <- sqrt(diag( vcovHC(log1s_3)))
re_log1s_3  = sqrt(diag(  cluster.vcov(log1s_3, short.data.compust$type1) ) )

log1s_4 <- glm(success_of_stated_obj ~(top20_number)+log(active.activist.share), data = short.data.compust, family = "binomial")
# re_log1s_4  <- sqrt(diag( vcovHC(log1s_4)))
re_log1s_4  = sqrt(diag(  cluster.vcov(log1s_4, short.data.compust$type1) ) )

log1s_5 <- glm(success_of_stated_obj ~(total.activist.number)+exit_s_board+exit_s_proxy, data = short.data.compust, family = "binomial")
# re_log1s_5   <- sqrt(diag( vcovHC(log1s_5)))
re_log1s_5  = sqrt(diag(  cluster.vcov(log1s_5, short.data.compust$type1) ) )

log1s_6 <- glm(success_of_stated_obj ~ (total.activist.number)+log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy, data = short.data.compust, family = "binomial")
# re_log1s_6   <- sqrt(diag( vcovHC(log1s_6) ))
re_log1s_6  = sqrt(diag(  cluster.vcov(log1s_6, short.data.compust$type1) ) )

log1s_7 <- glm(success_of_stated_obj ~ (top20_number)+exit_s_board+exit_s_proxy, data = short.data.compust, family = "binomial")
# re_log1s_7    <- sqrt(diag(vcovHC(log1s_7) ))
re_log1s_7  = sqrt(diag(  cluster.vcov(log1s_7, short.data.compust$type1) ) )

log1s_8 <- glm(success_of_stated_obj ~log(active.activist.share)+(top20_number)+exit_s_board+exit_s_proxy, data = short.data.compust, family = "binomial")
# re_log1s_8   <- sqrt(diag( vcovHC(log1s_8) ))
re_log1s_8  = sqrt(diag(  cluster.vcov(log1s_8, short.data.compust$type1) ) )


star=capture.output( stargazer(log1b_1, log1b_2, log1b_3, log1b_4, log1b_5, log1b_6, log1b_7, log1b_8,
                               type = "latex",  title = "Logit regressions with robust standard errors ", 
                               report = "vct*",
                               digits = 4,
                               header = FALSE, font.size = "tiny", float.env="sidewaystable", omit.stat=c("aic", "ll"),
                               se=list(re_log1b_1, re_log1b_2, re_log1b_3, re_log1b_4, re_log1b_5, re_log1b_6, re_log1b_7, re_log1b_8
                                )))

note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{15cm}{ \\textit{Notes:} Logistic regression  of the equation $Y = a + b x + g N +controls+e$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings. \\textit{investor.number} is a total number of institutional investors that hold shares of a company. \\textit{total.activist.number} is the number of passive activist investors that hold shares of the company. Activist investor is defined as any investor that appeared in SharkWatch database at least once. Robust standard errors in parenthesis.  }} \\\\"
star[grepl("Note",star)] <- note.latex
cat (star, sep = "\n")

star=capture.output( stargazer(log1s_1, log1s_2, log1s_3, log1s_4, log1s_5, log1s_6, log1s_7, log1s_8,
                               type = "latex",  title = "Logit regressions with robust standard errors ",
                               report = "vct*",
                               digits = 4,
                               header = FALSE, font.size = "tiny", float.env="sidewaystable", omit.stat=c("aic", "ll"),
                               se=list(re_log1s_1, re_log1s_2, re_log1s_3, re_log1s_4, re_log1s_5, re_log1s_6, re_log1s_7, re_log1s_8
                                )))

note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{15cm}{ \\textit{Notes:} Logistic regression  of the equation $Y = a + b x + g N +controls+e$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings. \\textit{investor.number} is a total number of institutional investors that hold shares of a company. \\textit{total.activist.number} is the number of passive activist investors that hold shares of the company. Activist investor is defined as any investor that appeared in SharkWatch database at least once. Robust standard errors in parenthesis.  }} \\\\"
star[grepl("Note",star)] <- note.latex
cat (star, sep = "\n")


# Run OLS regressions of type ONE -- with heter robust se's 

ols_1_binar_snum <- lm(won_board_ind ~total.activist.number, data = short.data.compust)
# robust_se_ols_1_binar_snum   <- sqrt(diag( vcovHC(ols_1_binar_snum)))
robust_se_ols_1_binar_snum  = sqrt(diag(  cluster.vcov(ols_1_binar_snum, short.data.compust$type1) ) )

ols_1_binar_size <- lm(won_board_ind ~top20_number, data = short.data.compust)
# robust_se_ols_1_binar_size   <- sqrt(diag( vcovHC(ols_1_binar_size)))
robust_se_ols_1_binar_size  = sqrt(diag(  cluster.vcov(ols_1_binar_size, short.data.compust$type1) ) )

ols1_a_cost <- lm(won_board_ind ~ total.activist.number+exit_s_board+exit_s_proxy, data = short.data.compust)
# robust_se_ols1_a_cost  <- sqrt(diag( vcovHC(ols1_a_cost) ))
robust_se_ols1_a_cost  = sqrt(diag(  cluster.vcov(ols1_a_cost, short.data.compust$type1) ) )


ols1_i_cost <- lm(won_board_ind ~ top20_number+exit_s_board+exit_s_proxy, data = short.data.compust)
# robust_se_ols1_i_cost  <- sqrt(diag( vcovHC(ols1_i_cost) ))
robust_se_ols1_i_cost  = sqrt(diag(  cluster.vcov(ols1_i_cost, short.data.compust$type1) ) )


ols1_binar <- lm(won_board_ind ~ total.activist.number+exit_s_board+exit_s_proxy+log(active.activist.share), data = short.data.compust)
# robust_se_ols1_binar   <- sqrt(diag( vcovHC(ols1_binar) ))
robust_se_ols1_binar  = sqrt(diag(  cluster.vcov(ols1_binar, short.data.compust$type1) ) )

ols1_binar_investor <- lm(won_board_ind ~ top20_number+log(active.activist.share)+exit_s_board+exit_s_proxy, data = short.data.compust)
# robust_se_ols1_binar_investor   <- sqrt(diag( vcovHC(ols1_binar_investor) ))
robust_se_ols1_binar_investor  = sqrt(diag(  cluster.vcov(ols1_binar_investor, short.data.compust$type1) ) )

ols1_binar_controls <- lm(won_board_ind ~ total.activist.number+log(active.activist.share)+exit_s_board+exit_s_proxy+age+log(size)+leverage+mtb, data = short.data.compust)
# robust_se_ols1_binar_controls   <- sqrt(diag( vcovHC(ols1_binar_controls) ))
robust_se_ols1_binar_controls  = sqrt(diag(  cluster.vcov(ols1_binar_controls, short.data.compust$type1) ) )


ols_1_classified_snum <- lm(success_of_stated_obj ~ (total.activist.number), data = short.data.compust)
robust_se_ols_1_classified_snum   <- sqrt(diag( vcovHC(ols_1_classified_snum)))
robust_se_ols_1_classified_snum  = sqrt(diag(  cluster.vcov(ols_1_classified_snum, short.data.compust$type1) ) )

ols_1_classified_size <- lm(success_of_stated_obj ~ top20_number, data = short.data.compust)
# robust_se_ols_1_classified_size   <- sqrt(diag( vcovHC(ols_1_classified_size)))
robust_se_ols_1_classified_size  = sqrt(diag(  cluster.vcov(ols_1_classified_size, short.data.compust$type1) ) )

ols1_a_cost_cl <- lm(success_of_stated_obj ~ total.activist.number+exit_s_board+exit_s_proxy, data = short.data.compust)
# robust_se_ols1_a_cost_cl  <- sqrt(diag( vcovHC(ols1_a_cost_cl) ))
robust_se_ols1_a_cost_cl  = sqrt(diag(  cluster.vcov(ols1_a_cost_cl, short.data.compust$type1) ) )

ols1_i_cost_cl <- lm(success_of_stated_obj ~ top20_number+exit_s_board+exit_s_proxy, data = short.data.compust)
# robust_se_ols1_i_cost_cl  <- sqrt(diag( vcovHC(ols1_i_cost_cl) ))
robust_se_ols1_i_cost_cl  = sqrt(diag(  cluster.vcov(ols1_i_cost_cl, short.data.compust$type1) ) )

ols1_classified <- lm(success_of_stated_obj ~ total.activist.number+exit_s_board+exit_s_proxy+log(active.activist.share), data = short.data.compust)
robust_se_ols1_classified   <- sqrt(diag( vcovHC(ols1_classified) ))
robust_se_ols1_classified  = sqrt(diag(  cluster.vcov(ols1_classified, short.data.compust$type1) ) )

ols1_classified_investor <- lm(success_of_stated_obj ~ top20_number+exit_s_board+exit_s_proxy+log(active.activist.share), data = short.data.compust)
# robust_se_ols1_classified_investor   <- sqrt(diag(vcovHC(ols1_classified_investor) ))
robust_se_ols1_classified_investor  = sqrt(diag(  cluster.vcov(ols1_classified_investor, short.data.compust$type1) ) )

# Add controls

ols1_classified_controls <- lm(success_of_stated_obj ~ total.activist.number+exit_s_board+exit_s_proxy+log(active.activist.share)+age+log(size)+leverage+mtb, data = short.data.compust)
# robust_se_ols1_classified_controls   <- sqrt(diag( vcovHC(ols1_classified_controls) ))
robust_se_ols1_classified_controls  = sqrt(diag(  cluster.vcov(ols1_classified_controls, short.data.compust$type1) ) )

# SECOND A STARGAZER OUTPUT IS HERE

star=capture.output(stargazer(ols_1_binar_snum,ols_1_binar_size, ols1_a_cost, ols1_i_cost,
                              ols1_binar,ols1_binar_investor,ols1_binar_controls,
                              type = "latex",  title = "OLS regressions with robust standard errors.", 
                              font.size = "tiny",
                               report = "vct*",
                              digits = 4,
                              float.env="sidewaystable",header = FALSE,omit.stat=c("f", "ser"),
                              se=list(robust_se_ols_1_binar_snum,robust_se_ols_1_binar_size,
                                      robust_se_ols1_a_cost, robust_se_ols1_i_cost,
                                      robust_se_ols1_binar,robust_se_ols1_binar_investor,robust_se_ols1_binar_controls
                                     )))

note.latex <- "\\multicolumn{8}{l} {\\parbox[t]{15cm}{ \\textit{Notes:} OLS regression  of the equation $Y = a + b x + g N +controls+e$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings. \\textit{investor.number} is a total number of institutional investors that hold shares of a company. \\textit{total.activist.number} is the number of passive activist investors that hold shares of the company. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \\textit{size} is the market value of the company. \\textit{age} is the age of the company. \\textit{leverage} is the leverage of the company.  Robust standard errors in parenthesis.  }} \\\\"
star[grepl("Note",star)] <- note.latex
cat (star, sep = "\n")


star=capture.output(stargazer(ols_1_classified_snum,ols_1_classified_size, 
                              ols1_a_cost_cl,ols1_i_cost_cl,
                              ols1_classified, ols1_classified_investor, ols1_classified_controls,
                              type = "latex",  title = "OLS regressions with robust standard errors.",
                              font.size = "tiny",
                              report = "vct*",
                              digits = 4,
                              float.env="sidewaystable",header = FALSE,omit.stat=c("f", "ser"),
                              se=list(robust_se_ols_1_classified_snum,robust_se_ols_1_classified_size, 
                                      robust_se_ols1_a_cost_cl,robust_se_ols1_i_cost_cl,
                                      robust_se_ols1_classified,
                                      robust_se_ols1_classified_investor,robust_se_ols1_classified_controls)))

note.latex <- "\\multicolumn{8}{l} {\\parbox[t]{15cm}{ \\textit{Notes:} OLS regression  of the equation $Y = a + b x + g N +controls+e$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings. \\textit{investor.number} is a total number of institutional investors that hold shares of a company. \\textit{total.activist.number} is the number of passive activist investors that hold shares of the company. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \\textit{size} is the market value of the company. \\textit{age} is the age of the company. \\textit{leverage} is the leverage of the company.  Robust standard errors in parenthesis.  }} \\\\"
star[grepl("Note",star)] <- note.latex
cat (star, sep = "\n")

# ------------------------------ OLS with number of connections that activist has

ols3d_1 <- lm(won_board_ind ~ log_act_num_con, data = short.data.compust)
re_ols3_1    <- sqrt(diag( vcovHC(ols3d_1) ))
# re_ols3_1  = sqrt(diag(  cluster.vcov(ols3d_1, short.data.compust$type1) ) )

ols3d_2 <- lm(won_board_ind ~ log_act_s, data = short.data.compust)
re_ols3_2   <- sqrt(diag( vcovHC(ols3d_2) ))
# re_ols3_2  = sqrt(diag(  cluster.vcov(ols3d_2, short.data.compust$type1) ) )

ols3d_3 <- lm(won_board_ind ~ log_act_num_con+exit_s_board+exit_s_proxy, data = short.data.compust)
re_ols3_3    <- sqrt(diag( vcovHC(ols3d_3) ))
# re_ols3_3  = sqrt(diag(  cluster.vcov(ols3d_3, short.data.compust$type1) ) )

ols3d_4 <- lm(won_board_ind ~ (log_act_s)+exit_s_board+exit_s_proxy, data = short.data.compust)
# re_ols3_4   <- sqrt(diag( vcovHC(ols3d_4) ))
re_ols3_4  = sqrt(diag(  cluster.vcov(ols3d_4, short.data.compust$type1) ) )

ols3d_5 <- lm(won_board_ind ~ (log_act_num_con) +log(active.activist.share), data = short.data.compust)
# re_ols3_5    <- sqrt(diag( vcovHC(ols3d_5) ))
re_ols3_5  = sqrt(diag(  cluster.vcov(ols3d_5, short.data.compust$type1) ) )

ols3d_6 <- lm(won_board_ind ~ (log_act_s) + log(active.activist.share), data = short.data.compust)
# re_ols3_6   <- sqrt(diag( vcovHC(ols3d_6) ))
re_ols3_6  = sqrt(diag(  cluster.vcov(ols3d_6, short.data.compust$type1) ) )

ols3d_7 <- lm(won_board_ind ~ (log_act_num_con) +exit_s_board+exit_s_proxy+log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy, data = short.data.compust)
# re_ols3_7   <- sqrt(diag( vcovHC(ols3d_7) ))
re_ols3_7  = sqrt(diag(  cluster.vcov(ols3d_7, short.data.compust$type1) ) )

ols3d_8 <- lm(won_board_ind ~ (log_act_s)+exit_s_board+exit_s_proxy+ log(active.activist.share) +age+scale(size)+leverage+mtb, data = short.data.compust)
# re_ols3_8   <- sqrt(diag( vcovHC(ols3d_8) ))
re_ols3_8  = sqrt(diag(  cluster.vcov(ols3d_8, short.data.compust$type1) ) )
##

ols3ss_1 <- lm(success_of_stated_obj~ (log_act_num_con), data = short.data.compust)
re_ols3s_1    <- sqrt(diag( vcovHC(ols3ss_1) ))
# re_ols3s_1  = sqrt(diag(  cluster.vcov(ols3ss_1, short.data.compust$type1) ) )

ols3ss_2 <- lm(success_of_stated_obj~ (log_act_s), data = short.data.compust)
re_ols3s_2   <- sqrt(diag( vcovHC(ols3ss_2) ))
# re_ols3s_2  = sqrt(diag(  cluster.vcov(ols3ss_2, short.data.compust$type1) ) )

ols3ss_3 <- lm(success_of_stated_obj~ (log_act_num_con)+exit_s_board+exit_s_proxy, data = short.data.compust)
re_ols3s_3    <- sqrt(diag( vcovHC(ols3ss_3) ))
# re_ols3s_3  = sqrt(diag(  cluster.vcov(ols3ss_3, short.data.compust$type1) ) )

ols3ss_4 <- lm(success_of_stated_obj~ (log_act_s)+exit_s_board+exit_s_proxy, data = short.data.compust)
re_ols3s_4   <- sqrt(diag( vcovHC(ols3ss_4) ))
# re_ols3s_4  = sqrt(diag(  cluster.vcov(ols3ss_4, short.data.compust$type1) ) )

ols3ss_5 <- lm(success_of_stated_obj~ (log_act_num_con) +log(active.activist.share), data = short.data.compust)
re_ols3s_5    <- sqrt(diag( vcovHC(ols3ss_5) ))
# re_ols3s_5  = sqrt(diag(  cluster.vcov(ols3ss_5, short.data.compust$type1) ) )

ols3ss_6 <- lm(success_of_stated_obj~ (log_act_s) + log(active.activist.share), data = short.data.compust)
re_ols3s_6   <- sqrt(diag( vcovHC(ols3ss_6) ))
# re_ols3s_6  = sqrt(diag(  cluster.vcov(ols3ss_6, short.data.compust$type1) ) )

ols3ss_7 <- lm(success_of_stated_obj~ (log_act_num_con) +exit_s_board+exit_s_proxy+log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy, data = short.data.compust)
re_ols3s_7   <- sqrt(diag( vcovHC(ols3ss_7) ))
# re_ols3s_7  = sqrt(diag(  cluster.vcov(ols3ss_7, short.data.compust$type1) ) )

ols3ss_8 <- lm(success_of_stated_obj~ (log_act_s)+exit_s_board+exit_s_proxy+ log(active.activist.share) +age+scale(size)+leverage+mtb, data = short.data.compust)
re_ols3s_8   <- sqrt(diag( vcovHC(ols3ss_8) ))
# re_ols3s_8  = sqrt(diag(  cluster.vcov(ols3ss_8, short.data.compust$type1) ) )

ols3_output = capture.output(stargazer(ols3d_1, ols3d_2, ols3d_3, ols3d_4, ols3d_5,ols3d_6,ols3d_7,ols3d_8,
                                       type = "latex",  
                                       title = "Basic spillower OLS regressions with robust standard errors",
                                       font.size = "tiny", float.env="sidewaystable",header = FALSE,
                                       omit.stat=c("f", "ser"),
                                        report = "vct*",
                                       digits = 4,
                                       se=list(re_ols3_1, re_ols3_2,re_ols3_3,re_ols3_4,re_ols3_5,
                                               re_ols3_6,re_ols3_7,re_ols3_8 )))

# 
note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{14cm}{ \\textit{Notes:} OLS regression  of the equation $Y = \\alpha + \\beta x + \\gamma \\bar{x} +controls+\\epsilon$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings.   \\textit{activist.size.vweghted} is the sum of all the company's activists' assets weighted by the share of investments in the company. \\textit{activist.size.average} is an average of total assets of company's activists. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \\textit{size} is the market value of the company. \\textit{age} is the age of the company. \\textit{leverage} is the leverage of the company.  Robust standard errors in parenthesis.  }} \\\\"
ols3_output[grepl("Note",ols3_output)] <- note.latex
cat (ols3_output, sep = "\n")

ols3s_output = capture.output(stargazer(ols3ss_1, ols3ss_2, ols3ss_3, ols3ss_4, ols3ss_5,ols3ss_6,ols3ss_7,ols3ss_8,
                                       type = "latex",  
                                       title = "Basic spillower OLS regressions with robust standard errors",
                                       font.size = "tiny", float.env="sidewaystable",header = FALSE,
                                       omit.stat=c("f", "ser"),
                                        report = "vct*",
                                       digits = 4,
                                       se=list(re_ols3s_1, re_ols3s_2,re_ols3s_3,re_ols3s_4,re_ols3s_5,
                                               re_ols3s_6,re_ols3s_7,re_ols3s_8 )))

# 
note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{14cm}{ \\textit{Notes:} OLS regression  of the equation $Y = \\alpha + \\beta x + \\gamma \\bar{x} +controls+\\epsilon$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings.   \\textit{activist.size.vweghted} is the sum of all the company's activists' assets weighted by the share of investments in the company. \\textit{activist.size.average} is an average of total assets of company's activists. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \\textit{size} is the market value of the company. \\textit{age} is the age of the company. \\textit{leverage} is the leverage of the company.  Robust standard errors in parenthesis.  }} \\\\"
ols3s_output[grepl("Note",ols3s_output)] <- note.latex
cat (ols3s_output, sep = "\n")

#----------OLS with networks weighted by top 20 fund network-----------------


ols3d_1 <- lm(won_board_ind ~ log_top20_share_nw_s, data = short.data.compust)
re_ols3_1    <- sqrt(diag( vcovHC(ols3d_1) ))
# re_ols3_1  = sqrt(diag(  cluster.vcov(ols3d_1, short.data.compust$type1) ) )

ols3d_2 <- lm(won_board_ind ~ log_top20_share_nw_spr, data = short.data.compust)
re_ols3_2   <- sqrt(diag( vcovHC(ols3d_2) ))
# re_ols3_2  = sqrt(diag(  cluster.vcov(ols3d_2, short.data.compust$type1) ) )

ols3d_3 <- lm(won_board_ind ~ log_top20_share_nw_s +exit_s_board+exit_s_proxy, data = short.data.compust)
re_ols3_3    <- sqrt(diag( vcovHC(ols3d_3) ))
# re_ols3_3  = sqrt(diag(  cluster.vcov(ols3d_3, short.data.compust$type1) ) )

ols3d_4 <- lm(won_board_ind ~ log_top20_share_nw_spr+exit_s_board+exit_s_proxy, data = short.data.compust)
re_ols3_4   <- sqrt(diag( vcovHC(ols3d_4) ))
# re_ols3_4  = sqrt(diag(  cluster.vcov(ols3d_4, short.data.compust$type1) ) )

ols3d_5 <- lm(won_board_ind ~ log_top20_share_nw_s +log(active.activist.share), data = short.data.compust)
re_ols3_5    <- sqrt(diag( vcovHC(ols3d_5) ))
# re_ols3_5  = sqrt(diag(  cluster.vcov(ols3d_5, short.data.compust$type1) ) )

ols3d_6 <- lm(won_board_ind ~ log_top20_share_nw_spr + log(active.activist.share), data = short.data.compust)
re_ols3_6   <- sqrt(diag( vcovHC(ols3d_6) ))
# re_ols3_6  = sqrt(diag(  cluster.vcov(ols3d_6, short.data.compust$type1) ) )

ols3d_7 <- lm(won_board_ind ~ log_top20_share_nw_s +exit_s_board+exit_s_proxy+ log(active.activist.share) +poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
re_ols3_7   <- sqrt(diag( vcovHC(ols3d_7) ))
# re_ols3_7  = sqrt(diag(  cluster.vcov(ols3d_7, short.data.compust$type1) ) )

ols3d_8 <- lm(won_board_ind ~ log_top20_share_nw_spr+exit_s_board+exit_s_proxy+ log(active.activist.share) +poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
re_ols3_8   <- sqrt(diag( vcovHC(ols3d_8) ))
# re_ols3_8  = sqrt(diag(  cluster.vcov(ols3d_8, short.data.compust$type1) ) )
##

ols3ss_1 <- lm(success_of_stated_obj~ log_top20_share_nw_spr, data = short.data.compust)
re_ols3s_1    <- sqrt(diag( vcovHC(ols3ss_1) ))
# re_ols3s_1  = sqrt(diag(  cluster.vcov(ols3ss_1, short.data.compust$type1) ) )

ols3ss_2 <- lm(success_of_stated_obj~ log_top20_share_nw_s, data = short.data.compust)
re_ols3s_2   <- sqrt(diag( vcovHC(ols3ss_2) ))
# re_ols3s_2  = sqrt(diag(  cluster.vcov(ols3ss_2, short.data.compust$type1) ) )

ols3ss_3 <- lm(success_of_stated_obj~ log_top20_share_nw_spr+exit_s_board+exit_s_proxy, data = short.data.compust)
re_ols3s_3    <- sqrt(diag( vcovHC(ols3ss_3) ))
# re_ols3s_3  = sqrt(diag(  cluster.vcov(ols3ss_3, short.data.compust$type1) ) )

ols3ss_4 <- lm(success_of_stated_obj~ log_top20_share_nw_s+exit_s_board+exit_s_proxy, data = short.data.compust)
re_ols3s_4   <- sqrt(diag( vcovHC(ols3ss_4) ))
# re_ols3s_4  = sqrt(diag(  cluster.vcov(ols3ss_4, short.data.compust$type1) ) )

ols3ss_5 <- lm(success_of_stated_obj~ log_top20_share_nw_spr +log(active.activist.share), data = short.data.compust)
re_ols3s_5    <- sqrt(diag( vcovHC(ols3ss_5) ))
# re_ols3s_5  = sqrt(diag(  cluster.vcov(ols3ss_5, short.data.compust$type1) ) )

ols3ss_6 <- lm(success_of_stated_obj~ log_top20_share_nw_s + log(active.activist.share), data = short.data.compust)
re_ols3s_6   <- sqrt(diag( vcovHC(ols3ss_6) ))
# re_ols3s_6  = sqrt(diag(  cluster.vcov(ols3ss_6, short.data.compust$type1) ) )

ols3ss_7 <- lm(success_of_stated_obj~ log_top20_share_nw_s+ log(active.activist.share) +exit_s_board+exit_s_proxy+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
re_ols3s_7   <- sqrt(diag( vcovHC(ols3ss_7) ))
# re_ols3s_7  = sqrt(diag(  cluster.vcov(ols3ss_7, short.data.compust$type1) ) )

ols3ss_8 <- lm(success_of_stated_obj~ log_top20_share_nw_spr +exit_s_board+exit_s_proxy+ log(active.activist.share)+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
re_ols3s_8   <- sqrt(diag( vcovHC(ols3ss_8) ))
# re_ols3s_8  = sqrt(diag(  cluster.vcov(ols3ss_8, short.data.compust$type1) ) )


ols3_output = capture.output(stargazer(ols3d_1, ols3d_2, ols3d_3, ols3d_4, ols3d_5,ols3d_6,ols3d_7,ols3d_8,
                                       type = "latex",  
                                       title = "Basic spillower OLS regressions with robust standard errors",
                                       font.size = "tiny", float.env="sidewaystable",header = FALSE,
                                       omit.stat=c("f", "ser"),
                                        report = "vct*",
                                       digits = 4,
                                       se=list(re_ols3_1, re_ols3_2,re_ols3_3,re_ols3_4,re_ols3_5,
                                               re_ols3_6,re_ols3_7,re_ols3_8 )))

# 
note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{14cm}{ \\textit{Notes:} OLS regression  of the equation $Y = \\alpha + \\beta x + \\gamma \\bar{x} +controls+\\epsilon$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings.   \\textit{activist.size.vweghted} is the sum of all the company's activists' assets weighted by the share of investments in the company. \\textit{activist.size.average} is an average of total assets of company's activists. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \\textit{size} is the market value of the company. \\textit{age} is the age of the company. \\textit{leverage} is the leverage of the company.  Robust standard errors in parenthesis.  }} \\\\"
ols3_output[grepl("Note",ols3_output)] <- note.latex
cat (ols3_output, sep = "\n")

ols3s_output = capture.output(stargazer(ols3ss_1, ols3ss_2, ols3ss_3, ols3ss_4, ols3ss_5,ols3ss_6,ols3ss_7,ols3ss_8,
                                       type = "latex",  
                                       title = "Basic spillower OLS regressions with robust standard errors",
                                       font.size = "tiny", float.env="sidewaystable",header = FALSE,
                                       omit.stat=c("f", "ser"),
                                        report = "vct*",
                                       digits = 4,
                                       se=list(re_ols3s_1, re_ols3s_2,re_ols3s_3,re_ols3s_4,re_ols3s_5,
                                               re_ols3s_6,re_ols3s_7,re_ols3s_8 )))

# 
note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{14cm}{ \\textit{Notes:} OLS regression  of the equation $Y = \\alpha + \\beta x + \\gamma \\bar{x} +controls+\\epsilon$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings.   \\textit{activist.size.vweghted} is the sum of all the company's activists' assets weighted by the share of investments in the company. \\textit{activist.size.average} is an average of total assets of company's activists. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \\textit{size} is the market value of the company. \\textit{age} is the age of the company. \\textit{leverage} is the leverage of the company.  Robust standard errors in parenthesis.  }} \\\\"
ols3s_output[grepl("Note",ols3s_output)] <- note.latex
cat (ols3s_output, sep = "\n")

#----------OLS with networks weighted by top 20 fund network with weights----------------


ols3d_1 <- lm(won_board_ind ~ log_top20_w_norm_s , data = short.data.compust)
re_ols3_1    <- sqrt(diag( vcovHC(ols3d_1) ))
# re_ols3_1  = sqrt(diag(  cluster.vcov(ols3d_1, short.data.compust$type1) ) )

ols3d_2 <- lm(won_board_ind ~ log_top20_w_norm_spr, data = short.data.compust)
re_ols3_2   <- sqrt(diag( vcovHC(ols3d_2) ))
# re_ols3_2  = sqrt(diag(  cluster.vcov(ols3d_2, short.data.compust$type1) ) )

ols3d_3 <- lm(won_board_ind ~ log_top20_w_norm_s +exit_s_board+exit_s_proxy, data = short.data.compust)
re_ols3_3    <- sqrt(diag( vcovHC(ols3d_3) ))
# re_ols3_3  = sqrt(diag(  cluster.vcov(ols3d_3, short.data.compust$type1) ) )

ols3d_4 <- lm(won_board_ind ~ log_top20_w_norm_spr+exit_s_board+exit_s_proxy, data = short.data.compust)
re_ols3_4   <- sqrt(diag( vcovHC(ols3d_4) ))
# re_ols3_4  = sqrt(diag(  cluster.vcov(ols3d_4, short.data.compust$type1) ) )

ols3d_5 <- lm(won_board_ind ~ log_top20_w_norm_s +log_active.activist_norm_weight, data = short.data.compust)
re_ols3_5    <- sqrt(diag( vcovHC(ols3d_5) ))
# re_ols3_5  = sqrt(diag(  cluster.vcov(ols3d_5, short.data.compust$type1) ) )

ols3d_6 <- lm(won_board_ind ~ log_top20_w_norm_spr + log_active.activist_norm_weight, data = short.data.compust)
re_ols3_6   <- sqrt(diag( vcovHC(ols3d_6) ))
# re_ols3_6  = sqrt(diag(  cluster.vcov(ols3d_6, short.data.compust$type1) ) )

ols3d_7 <- lm(won_board_ind ~ log_top20_w_norm_s +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight +poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
re_ols3_7   <- sqrt(diag( vcovHC(ols3d_7) ))
# re_ols3_7  = sqrt(diag(  cluster.vcov(ols3d_7, short.data.compust$type1) ) )

ols3d_8 <- lm(won_board_ind ~ log_top20_w_norm_spr+exit_s_board+exit_s_proxy+ log_active.activist_norm_weight +poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
re_ols3_8   <- sqrt(diag( vcovHC(ols3d_8) ))
# re_ols3_8  = sqrt(diag(  cluster.vcov(ols3d_8, short.data.compust$type1) ) )
##

ols3ss_1 <- lm(success_of_stated_obj~ log_top20_w_norm_s, data = short.data.compust)
re_ols3s_1    <- sqrt(diag( vcovHC(ols3ss_1) ))
# re_ols3s_1  = sqrt(diag(  cluster.vcov(ols3ss_1, short.data.compust$type1) ) )

ols3ss_2 <- lm(success_of_stated_obj~ log_top20_w_norm_spr, data = short.data.compust)
re_ols3s_2   <- sqrt(diag( vcovHC(ols3ss_2) ))
# re_ols3s_2  = sqrt(diag(  cluster.vcov(ols3ss_2, short.data.compust$type1) ) )

ols3ss_3 <- lm(success_of_stated_obj~ log_top20_w_norm_s+exit_s_board+exit_s_proxy, data = short.data.compust)
re_ols3s_3    <- sqrt(diag( vcovHC(ols3ss_3) ))
# re_ols3s_3  = sqrt(diag(  cluster.vcov(ols3ss_3, short.data.compust$type1) ) )

ols3ss_4 <- lm(success_of_stated_obj~ log_top20_w_norm_spr+exit_s_board+exit_s_proxy, data = short.data.compust)
re_ols3s_4   <- sqrt(diag( vcovHC(ols3ss_4) ))
# re_ols3s_4  = sqrt(diag(  cluster.vcov(ols3ss_4, short.data.compust$type1) ) )

ols3ss_5 <- lm(success_of_stated_obj~ log_top20_w_norm_s +log_active.activist_norm_weight, data = short.data.compust)
re_ols3s_5    <- sqrt(diag( vcovHC(ols3ss_5) ))
# re_ols3s_5  = sqrt(diag(  cluster.vcov(ols3ss_5, short.data.compust$type1) ) )

ols3ss_6 <- lm(success_of_stated_obj~ log_top20_w_norm_spr + log_active.activist_norm_weight, data = short.data.compust)
re_ols3s_6   <- sqrt(diag( vcovHC(ols3ss_6) ))
# re_ols3s_6  = sqrt(diag(  cluster.vcov(ols3ss_6, short.data.compust$type1) ) )

ols3ss_7 <- lm(success_of_stated_obj~ log_top20_w_norm_s+log_active.activist_norm_weight +exit_s_board+exit_s_proxy+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
re_ols3s_7   <- sqrt(diag( vcovHC(ols3ss_7) ))
# re_ols3s_7  = sqrt(diag(  cluster.vcov(ols3ss_7, short.data.compust$type1) ) )

ols3ss_8 <- lm(success_of_stated_obj~ log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
re_ols3s_8   <- sqrt(diag( vcovHC(ols3ss_8) ))
# re_ols3s_8  = sqrt(diag(  cluster.vcov(ols3ss_8, short.data.compust$type1) ) )


ols3_output = capture.output(stargazer(ols3d_1, ols3d_2, ols3d_3, ols3d_4, ols3d_5,ols3d_6,ols3d_7,ols3d_8,
                                       type = "latex",  
                                       title = "Basic spillower OLS regressions with robust standard errors",
                                       font.size = "tiny", float.env="sidewaystable",header = FALSE,
                                       omit.stat=c("f", "ser"),
                                        report = "vct*",
                                       digits = 4,
                                       se=list(re_ols3_1, re_ols3_2,re_ols3_3,re_ols3_4,re_ols3_5,
                                               re_ols3_6,re_ols3_7,re_ols3_8 )))

# 
note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{14cm}{ \\textit{Notes:} OLS regression  of the equation $Y = \\alpha + \\beta x + \\gamma \\bar{x} +controls+\\epsilon$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings.   \\textit{activist.size.vweghted} is the sum of all the company's activists' assets weighted by the share of investments in the company. \\textit{activist.size.average} is an average of total assets of company's activists. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \\textit{size} is the market value of the company. \\textit{age} is the age of the company. \\textit{leverage} is the leverage of the company.  Robust standard errors in parenthesis.  }} \\\\"
ols3_output[grepl("Note",ols3_output)] <- note.latex
cat (ols3_output, sep = "\n")

ols3s_output = capture.output(stargazer(ols3ss_1, ols3ss_2, ols3ss_3, ols3ss_4, ols3ss_5,ols3ss_6,ols3ss_7,ols3ss_8,
                                       type = "latex",  
                                       title = "Basic spillower OLS regressions with robust standard errors",
                                       font.size = "tiny", float.env="sidewaystable",header = FALSE,
                                       omit.stat=c("f", "ser"),
                                        report = "vct*",
                                       digits = 4,
                                       se=list(re_ols3s_1, re_ols3s_2,re_ols3s_3,re_ols3s_4,re_ols3s_5,
                                               re_ols3s_6,re_ols3s_7,re_ols3s_8 )))

# 
note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{14cm}{ \\textit{Notes:} OLS regression  of the equation $Y = \\alpha + \\beta x + \\gamma \\bar{x} +controls+\\epsilon$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings.   \\textit{activist.size.vweghted} is the sum of all the company's activists' assets weighted by the share of investments in the company. \\textit{activist.size.average} is an average of total assets of company's activists. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \\textit{size} is the market value of the company. \\textit{age} is the age of the company. \\textit{leverage} is the leverage of the company.  Robust standard errors in parenthesis.  }} \\\\"
ols3s_output[grepl("Note",ols3s_output)] <- note.latex
cat (ols3s_output, sep = "\n")


# WIth different measure


#----------OLS with networks weighted by top 20 fund network with weights----------------


ols3d_1 <- lm(won_board_ind ~ log_top20_w_sd_s , data = short.data.compust)
# re_ols3_1    <- sqrt(diag( vcovHC(ols3d_1) ))
re_ols3_1  = sqrt(diag(  cluster.vcov(ols3d_1, short.data.compust$type1) ) )

ols3d_2 <- lm(won_board_ind ~ log_top20_w_sd_spr, data = short.data.compust)
# re_ols3_2   <- sqrt(diag( vcovHC(ols3d_2) ))
re_ols3_2  = sqrt(diag(  cluster.vcov(ols3d_2, short.data.compust$type1) ) )

ols3d_3 <- lm(won_board_ind ~ log_top20_w_sd_s +exit_s_board+exit_s_proxy, data = short.data.compust)
# re_ols3_3    <- sqrt(diag( vcovHC(ols3d_3) ))
re_ols3_3  = sqrt(diag(  cluster.vcov(ols3d_3, short.data.compust$type1) ) )

ols3d_4 <- lm(won_board_ind ~ log_top20_w_sd_spr+exit_s_board+exit_s_proxy, data = short.data.compust)
# re_ols3_4   <- sqrt(diag( vcovHC(ols3d_4) ))
re_ols3_4  = sqrt(diag(  cluster.vcov(ols3d_4, short.data.compust$type1) ) )

ols3d_5 <- lm(won_board_ind ~ log_top20_w_sd_s +log_active.activist_sd_weight, data = short.data.compust)
# re_ols3_5    <- sqrt(diag( vcovHC(ols3d_5) ))
re_ols3_5  = sqrt(diag(  cluster.vcov(ols3d_5, short.data.compust$type1) ) )

ols3d_6 <- lm(won_board_ind ~ log_top20_w_sd_spr + log_active.activist_sd_weight, data = short.data.compust)
# re_ols3_6   <- sqrt(diag( vcovHC(ols3d_6) ))
re_ols3_6  = sqrt(diag(  cluster.vcov(ols3d_6, short.data.compust$type1) ) )

ols3d_7 <- lm(won_board_ind ~ log_top20_w_sd_s +exit_s_board+exit_s_proxy+ log_active.activist_sd_weight +poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
# re_ols3_7   <- sqrt(diag( vcovHC(ols3d_7) ))
re_ols3_7  = sqrt(diag(  cluster.vcov(ols3d_7, short.data.compust$type1) ) )

ols3d_8 <- lm(won_board_ind ~ log_top20_w_sd_spr+exit_s_board+exit_s_proxy+ log_active.activist_sd_weight +poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
# re_ols3_8   <- sqrt(diag( vcovHC(ols3d_8) ))
re_ols3_8  = sqrt(diag(  cluster.vcov(ols3d_8, short.data.compust$type1) ) )
##

ols3ss_1 <- lm(success_of_stated_obj~ log_top20_w_sd_s, data = short.data.compust)
# re_ols3s_1    <- sqrt(diag( vcovHC(ols3ss_1) ))
re_ols3s_1  = sqrt(diag(  cluster.vcov(ols3ss_1, short.data.compust$type1) ) )

ols3ss_2 <- lm(success_of_stated_obj~ log_top20_w_sd_spr, data = short.data.compust)
# re_ols3s_2   <- sqrt(diag( vcovHC(ols3ss_2) ))
re_ols3s_2  = sqrt(diag(  cluster.vcov(ols3ss_2, short.data.compust$type1) ) )

ols3ss_3 <- lm(success_of_stated_obj~ log_top20_w_sd_s+exit_s_board+exit_s_proxy, data = short.data.compust)
# re_ols3s_3    <- sqrt(diag( vcovHC(ols3ss_3) ))
re_ols3s_3  = sqrt(diag(  cluster.vcov(ols3ss_3, short.data.compust$type1) ) )

ols3ss_4 <- lm(success_of_stated_obj~ log_top20_w_sd_spr+exit_s_board+exit_s_proxy, data = short.data.compust)
# re_ols3s_4   <- sqrt(diag( vcovHC(ols3ss_4) ))
re_ols3s_4  = sqrt(diag(  cluster.vcov(ols3ss_4, short.data.compust$type1) ) )

ols3ss_5 <- lm(success_of_stated_obj~ log_top20_w_sd_s +log_active.activist_sd_weight, data = short.data.compust)
# re_ols3s_5    <- sqrt(diag( vcovHC(ols3ss_5) ))
re_ols3s_5  = sqrt(diag(  cluster.vcov(ols3ss_5, short.data.compust$type1) ) )

ols3ss_6 <- lm(success_of_stated_obj~ log_top20_w_sd_spr + log_active.activist_sd_weight, data = short.data.compust)
# re_ols3s_6   <- sqrt(diag( vcovHC(ols3ss_6) ))
re_ols3s_6  = sqrt(diag(  cluster.vcov(ols3ss_6, short.data.compust$type1) ) )

ols3ss_7 <- lm(success_of_stated_obj~ log_top20_w_sd_s+log_active.activist_sd_weight +exit_s_board+exit_s_proxy+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
# re_ols3s_7   <- sqrt(diag( vcovHC(ols3ss_7) ))
re_ols3s_7  = sqrt(diag(  cluster.vcov(ols3ss_7, short.data.compust$type1) ) )

ols3ss_8 <- lm(success_of_stated_obj~ log_top20_w_sd_spr +exit_s_board+exit_s_proxy+ log_active.activist_sd_weight+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
# re_ols3s_8   <- sqrt(diag( vcovHC(ols3ss_8) ))
re_ols3s_8  = sqrt(diag(  cluster.vcov(ols3ss_8, short.data.compust$type1) ) )


ols3_output = capture.output(stargazer(ols3d_1, ols3d_2, ols3d_3, ols3d_4, ols3d_5,ols3d_6,ols3d_7,ols3d_8,
                                       type = "latex",  
                                       title = "Basic spillower OLS regressions with robust standard errors",
                                       font.size = "tiny", float.env="sidewaystable",header = FALSE,
                                       omit.stat=c("f", "ser"),
                                        report = "vct*",
                                       digits = 4,
                                       se=list(re_ols3_1, re_ols3_2,re_ols3_3,re_ols3_4,re_ols3_5,
                                               re_ols3_6,re_ols3_7,re_ols3_8 )))

# 
note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{14cm}{ \\textit{Notes:} OLS regression  of the equation $Y = \\alpha + \\beta x + \\gamma \\bar{x} +controls+\\epsilon$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings.   \\textit{activist.size.vweghted} is the sum of all the company's activists' assets weighted by the share of investments in the company. \\textit{activist.size.average} is an average of total assets of company's activists. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \\textit{size} is the market value of the company. \\textit{age} is the age of the company. \\textit{leverage} is the leverage of the company.  Robust standard errors in parenthesis.  }} \\\\"
ols3_output[grepl("Note",ols3_output)] <- note.latex
cat (ols3_output, sep = "\n")

ols3s_output = capture.output(stargazer(ols3ss_1, ols3ss_2, ols3ss_3, ols3ss_4, ols3ss_5,ols3ss_6,ols3ss_7,ols3ss_8,
                                       type = "latex",  
                                       title = "Basic spillower OLS regressions with robust standard errors",
                                       font.size = "tiny", float.env="sidewaystable",header = FALSE,
                                       omit.stat=c("f", "ser"),
                                        report = "vct*",
                                       digits = 4,
                                       se=list(re_ols3s_1, re_ols3s_2,re_ols3s_3,re_ols3s_4,re_ols3s_5,
                                               re_ols3s_6,re_ols3s_7,re_ols3s_8 )))

# 
note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{14cm}{ \\textit{Notes:} OLS regression  of the equation $Y = \\alpha + \\beta x + \\gamma \\bar{x} +controls+\\epsilon$.
 \\textit{won\\_brep\\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\\textit{success\\_of\\_stated\\_obj} is an indicator of fulfillment of activists' demands.  \\textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings.   \\textit{activist.size.vweghted} is the sum of all the company's activists' assets weighted by the share of investments in the company. \\textit{activist.size.average} is an average of total assets of company's activists. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \\textit{size} is the market value of the company. \\textit{age} is the age of the company. \\textit{leverage} is the leverage of the company.  Robust standard errors in parenthesis.  }} \\\\"
ols3s_output[grepl("Note",ols3s_output)] <- note.latex
cat (ols3s_output, sep = "\n")




cor2 = short.data.compust[c("success_of_stated_obj", "won_board_ind", "total.activist.number", "activist.size.vweighted", "activist.size.average","age","leverage","size","mtb","oper_profit",  "act_s_clos", "act_s_betw", "act_s_bon", "act_sp_clos",  "act_sp_betw", "act_sp_bon",
                               "oth_s_clos","oth_s_betw", "oth_s_bon", "oth_sp_clos", 
                               "oth_sp_betw", "oth_sp_bon" )]

upper2=round( cor(cor2, use="pairwise.complete.obs"), 2)
upper2[upper.tri(upper2)]<-""

upper2<-as.data.frame(upper2)
names(upper2) <- c(1:nrow(upper2))
rownames(upper2) = paste0(1:nrow(upper2)," ", rownames(upper2))
upper2_tex <- xtable(upper2,include.rownames=TRUE, digits=2)

print(upper2_tex,
      only.contents=TRUE,
      include.rownames=TRUE,
      include.colnames = TRUE,
      type="latex",

      floating = FALSE,
      hline.after = NULL, comment = FALSE,
      file="C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/upper2_tex.tex")
```


\fontsize{10}{10}\selectfont
\begin{center}
\begin{sidewaystable}[p]\scriptsize
		\caption{\scriptsize \textbf{Correlation table.}  \textit{won\_brep\_dummy} is an indicator variable equal to 1 when at least 1 activist nominee was elected to the board.\textit{success\_of\_stated\_obj} is an indicator of fulfillment of activists' demands. \textit{active.activist.size} correponds to the total assets of an activist group, computed from 13F filings. \textit{investor.number} is a total number of institutional investors that hold shares of a company. \textit{total.activist.number} is the number of passive activist investors that hold shares of the company. Activist investor is defined as any investor that appeared in SharkWatch database at least once. \textit{activist.size.vweghted} is the sum of all the company's activists' assets weighted by the share of investments in the company. \textit{activist.size.average} is an average of total assets of company's activists. \textit{size} is the market value of the company. \textit{age} is the age of the company. \textit{leverage} is the leverage of the company. \textit{mtb} is the market-to-book ratio of the company. \textit{oper\_profit} is an operating profitability of the company. All the other variables are centrality measures of activist network. Centrality captures the importance of the node position in a network. Three centrality measures are used. Closeness centrality shows how close each node to any other node. Betweennes centrality captures how well situated a node is in terms of the paths that it lies on. Degree centrality, is defined a the number of links incident to a node. Bonacich centrality is a degree centrality adjusted for the centrality of the neighbours in a network. The centrality measures were computed for both Simple and Spring networks. (By construction, centrality measures for Simple network are identical to the centrality measures of Number of Connections network.) I aggregated the centrality measures for each campaign. That is, \textit{act\_simple\_closeness} is a sum of closeness centralities of every active activist participating in a campaign, and \textit{oth\_simple\_closeness} is a sum of closeness centralities of every passive activist that invested in the company but does not participate in a campaign.}\centering \tiny
\begin{tabular}{p{3.1cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}}
\hline\hline
	\input{"C:/Users/anakhmur/Documents/Networks/Analysis/Code/markdown/upper2_tex.tex"}
	\hline\hline
\end{tabular}
\end{sidewaystable}
\end{center}

```{r star2, results = 'asis', warning=FALSE, message=FALSE,echo=FALSE}
# Regressions are done here!

library(stargazer, quietly = TRUE)
library(sandwich, quietly = TRUE)
library(lmtest, quietly= TRUE)
library(multiwayvcov, quietly= TRUE)
library(lfe, quietly= TRUE)




centr_b_1 <- lm(won_board_ind ~ log_act_s_clos+log_top20_s_clos, data = short.data.compust)
# re_centr_b_1   <- sqrt(diag( vcovHC(centr_b_1) ))
re_centr_b_1  = sqrt(diag(  cluster.vcov(centr_b_1, short.data.compust$type1) ) )

centr_b_2 <- lm(won_board_ind ~ log_act_s_clos+log_top20_s_clos+exit_s_board+exit_s_proxy+poison_pill+mtb, data = short.data.compust)
# re_centr_b_2   <- sqrt(diag( vcovHC(centr_b_2) ))
re_centr_b_2  = sqrt(diag(  cluster.vcov(centr_b_2, short.data.compust$type1) ) )

centr_b_3 <- lm(won_board_ind ~ log_act_s_betw+log_top20_s_betw, data = short.data.compust)
# re_centr_b_3  <- sqrt(diag( vcovHC(centr_b_3) ))
re_centr_b_3  = sqrt(diag(  cluster.vcov(centr_b_3, short.data.compust$type1) ) )

centr_b_4 <- lm(won_board_ind ~ log_act_s_betw+log_top20_s_betw+exit_s_board+exit_s_proxy+poison_pill+mtb, data = short.data.compust)
# re_centr_b_4  <- sqrt(diag( vcovHC(centr_b_4) ))
re_centr_b_4  = sqrt(diag(  cluster.vcov(centr_b_4, short.data.compust$type1) ) )

centr_b_5 <- lm(won_board_ind ~ log_act_sp_clos+log_top20_sp_clos, data = short.data.compust)
# re_centr_b_5   <- sqrt(diag( vcovHC(centr_b_5) ))
re_centr_b_5  = sqrt(diag(  cluster.vcov(centr_b_5, short.data.compust$type1) ) )

centr_b_6 <- lm(won_board_ind ~ log_act_sp_clos+log_top20_sp_clos+exit_s_board+exit_s_proxy+poison_pill+mtb , data = short.data.compust)
# re_centr_b_6   <- sqrt(diag( vcovHC(centr_b_6) ))
re_centr_b_6  = sqrt(diag(  cluster.vcov(centr_b_6, short.data.compust$type1) ) )

centr_b_7 <- lm(won_board_ind ~ log_act_sp_betw+log_top20_sp_betw, data = short.data.compust)
# re_centr_b_7  <- sqrt(diag( vcovHC(centr_b_7) ))
re_centr_b_7  = sqrt(diag(  cluster.vcov(centr_b_7, short.data.compust$type1) ) )

centr_b_8 <- lm(won_board_ind ~ log_act_sp_betw+log_top20_sp_betw+exit_s_board+exit_s_proxy+poison_pill+mtb, data = short.data.compust)
# re_centr_b_8  <- sqrt(diag( vcovHC(centr_b_8) ))
re_centr_b_8  = sqrt(diag(  cluster.vcov(centr_b_8, short.data.compust$type1) ) )


centr_s_1 <- lm(success_of_stated_obj~ log_act_s_clos+log_top20_s_clos, data = short.data.compust)
# re_centr_s_1   <- sqrt(diag( vcovHC(centr_s_1) ))
re_centr_s_1  = sqrt(diag(  cluster.vcov(centr_s_1, short.data.compust$type1) ) )

centr_s_2 <- lm(success_of_stated_obj~ log_act_s_clos+log_top20_s_clos+exit_s_board+exit_s_proxy+poison_pill+mtb, data = short.data.compust)
# re_centr_s_2  <- sqrt(diag( vcovHC(centr_s_2) ))
re_centr_s_2  = sqrt(diag(  cluster.vcov(centr_s_2, short.data.compust$type1) ) )

centr_s_3 <- lm(success_of_stated_obj~ log_act_s_betw+log_top20_s_betw, data = short.data.compust)
# re_centr_s_3   <- sqrt(diag( vcovHC(centr_s_3) ))
re_centr_s_3  = sqrt(diag(  cluster.vcov(centr_s_3, short.data.compust$type1) ) )

centr_s_4 <- lm(success_of_stated_obj~ log_act_s_betw+log_top20_s_betw+exit_s_board+exit_s_proxy+poison_pill+mtb, data = short.data.compust)
# re_centr_s_4  <- sqrt(diag( vcovHC(centr_s_4) ))
re_centr_s_4  = sqrt(diag(  cluster.vcov(centr_s_4, short.data.compust$type1) ) )

centr_s_5 <- lm(success_of_stated_obj~ log_act_sp_clos+log_top20_sp_clos, data = short.data.compust)
# re_centr_s_5   <- sqrt(diag( vcovHC(centr_s_5) ))
re_centr_s_5  = sqrt(diag(  cluster.vcov(centr_s_5, short.data.compust$type1) ) )

centr_s_6 <- lm(success_of_stated_obj~ log_act_sp_clos+log_top20_sp_clos+exit_s_board+exit_s_proxy+poison_pill+mtb, data = short.data.compust)
# re_centr_s_6  <- sqrt(diag( vcovHC(centr_s_6) ))
re_centr_s_6  = sqrt(diag(  cluster.vcov(centr_s_6, short.data.compust$type1) ) )

centr_s_7 <- lm(success_of_stated_obj~ log_act_sp_betw+log_top20_sp_betw, data = short.data.compust)
# re_centr_s_7   <- sqrt(diag( vcovHC(centr_s_7) ))
re_centr_s_7  = sqrt(diag(  cluster.vcov(centr_s_7, short.data.compust$type1) ) )

centr_s_8 <- lm(success_of_stated_obj~ log_act_sp_betw+log_top20_sp_betw+exit_s_board+exit_s_proxy+poison_pill+mtb, data = short.data.compust)
# re_centr_s_8  <- sqrt(diag( vcovHC(centr_s_8) ))
re_centr_s_8  = sqrt(diag(  cluster.vcov(centr_s_8, short.data.compust$type1) ) )



ols3_output = capture.output( stargazer(centr_b_1,centr_b_2,centr_b_3,centr_b_4,
                                        centr_b_5,
                                        centr_b_6, 
                                        centr_b_7,
                                        centr_b_8,
                                       type = "latex",  title = " OLS regressions with centrality measures, robust se",header = FALSE,
                                       report = "vct*", 
                                       digits = 4,
                                       omit.stat=c("f", "ser"), font.size = "tiny", float.env="sidewaystable",
                                       se=list(re_centr_b_1, re_centr_b_2, re_centr_b_3, re_centr_b_4,
                                               re_centr_b_5,
                                               re_centr_b_6, 
                                               re_centr_b_7,
                                               re_centr_b_8)))


note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{22cm}{\\footnotesize \\textit{Notes:} OLS regression  of the equation $Y = \\alpha + \\beta x + \\gamma \\bar{x} +controls+\\epsilon$.The regressions are run using the centrality measures to proxy for persuasiveness of an activist. Centrality is a characteristic of a node that captures the importance of the node position in a network. I use three centrality measures for this analysis. Closeness centrality shows how close each node to any other node. Betweennes centrality captures how well situated a node is in terms of the paths that it lies on. Degree centrality, is defined a the number of links incident to a node. Bonacich centrality is a degree centrality adjusted for the centrality of the neighbours in a network. The centrality measures were computed for both Simple and Spring networks. (By construction, centrality measures for Simple network are identical to the centrality measures of Number of Connections network.) After that I aggregated the centrality measures for each campaign. That is, $act\\_simple\\_closeness$ is a sum of closeness centralities of every active activist participating in a campaign, and $oth\\_simple\\_closeness$ is a sum of closeness centralities of every passive activist that invested in the company but does not participate in a campaign. 
Robust standard errors in parenthesis. }} \\\\"
ols3_output[grepl("Note",ols3_output)] <- note.latex
cat (ols3_output, sep = "\n")

ols3_output = capture.output( stargazer(centr_s_1,centr_s_2,centr_s_3,centr_s_4,
                                        centr_s_5, centr_s_6, centr_s_7, centr_s_8,
                                       type = "latex",  title = " OLS regressions with centrality measures, robust se",header = FALSE,
                                       report = "vct*", 
                                       digits = 4,
                                       omit.stat=c("f", "ser"), font.size = "tiny", float.env="sidewaystable",
                                       se=list(re_centr_s_1, re_centr_s_2, re_centr_s_3, re_centr_s_4,
                                               re_centr_s_5, re_centr_s_6, re_centr_s_7, re_centr_s_8
                                               )))


note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{22cm}{\\footnotesize \\textit{Notes:} OLS regression  of the equation $Y = \\alpha + \\beta x + \\gamma \\bar{x} +controls+\\epsilon$.The regressions are run using the centrality measures to proxy for persuasiveness of an activist. Centrality is a characteristic of a node that captures the importance of the node position in a network. I use three centrality measures for this analysis. Closeness centrality shows how close each node to any other node. Betweennes centrality captures how well situated a node is in terms of the paths that it lies on. Degree centrality, is defined a the number of links incident to a node. Bonacich centrality is a degree centrality adjusted for the centrality of the neighbours in a network. The centrality measures were computed for both Simple and Spring networks. (By construction, centrality measures for Simple network are identical to the centrality measures of Number of Connections network.) After that I aggregated the centrality measures for each campaign. That is, $act\\_simple\\_closeness$ is a sum of closeness centralities of every active activist participating in a campaign, and $oth\\_simple\\_closeness$ is a sum of closeness centralities of every passive activist that invested in the company but does not participate in a campaign. 
Robust standard errors in parenthesis. }} \\\\"
ols3_output[grepl("Note",ols3_output)] <- note.latex
cat (ols3_output, sep = "\n")


#### TABLES FOR PRES HERE


log1s_7 <- lm(success_of_stated_obj ~ (top20_number)+short_term+exit_s_board+exit_s_proxy+log(active.activist.share)+log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb+factor(holder_type), data = short.data.compust)
# re_log1s_7    <- sqrt(diag(vcovHC(log1s_7) ))
re_log1s_7  = sqrt(diag(  cluster.vcov(log1s_7, short.data.compust$type1) ) )


reg1 <- lm(success_of_stated_obj ~ top20_number+exit_s_board+exit_s_proxy+log(active.activist.share)+ log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy +poison_pill+age+log(size)+leverage+mtb
           # +factor(holder_type)
           , data = short.data.compust)
# se1   <- sqrt(diag(vcovHC(reg1) ))
se1  = sqrt(diag(  cluster.vcov(reg1, short.data.compust$type1) ) )

reg2 <- lm(success_of_stated_obj~ (log_act_num_con) +exit_s_board+exit_s_proxy+log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb
           # +factor(holder_type)
           , data = short.data.compust)
se2   <- sqrt(diag( vcovHC(reg2) ))
# se2  = sqrt(diag(  cluster.vcov(reg2, short.data.compust$type1) ) )

reg3 <- lm(success_of_stated_obj~ log_top20_share_nw_s +exit_s_board+exit_s_proxy+log(active.activist.share)+log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb
           # + factor(holder_type)
           ,data = short.data.compust)
se3   <- sqrt(diag( vcovHC(reg3) ))
# se3  = sqrt(diag(  cluster.vcov(reg3, short.data.compust$type1) ) )

reg4 <- lm(success_of_stated_obj~ log_top20_share_nw_spr +exit_s_board+exit_s_proxy+ log(active.activist.share)+log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb
           # +factor(holder_type)
           ,data = short.data.compust)
se4   <- sqrt(diag( vcovHC(reg4) ))
# se4  = sqrt(diag(  cluster.vcov(reg4, short.data.compust$type1) ) )

reg5 <- lm(success_of_stated_obj~ log_top20_w_norm_s +exit_s_board+exit_s_proxy+log_active.activist_norm_weight+log_active.activist_norm_weight*exit_s_board+
             log_active.activist_norm_weight*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb
           # +factor(holder_type)
           , data = short.data.compust)
se5   <- sqrt(diag( vcovHC(reg5) ))
# se5  = sqrt(diag(  cluster.vcov(reg5, short.data.compust$type1) ) )

reg6 <- lm(success_of_stated_obj~ log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight+log_active.activist_norm_weight*exit_s_board+log_active.activist_norm_weight*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb
           # +factor(holder_type)
           , data = short.data.compust)
se6   <- sqrt(diag( vcovHC(reg6) ))
# se6  = sqrt(diag(  cluster.vcov(reg6, short.data.compust$type1) ) )


reg7 <- lm(success_of_stated_obj~ log_top20_w_sd_s++exit_s_board+exit_s_proxy+log_active.activist_sd_weight+log_active.activist_sd_weight*exit_s_board+log_active.activist_sd_weight*exit_s_proxy +poison_pill+age+log(size)+leverage+mtb
           # +factor(holder_type)
           , data = short.data.compust)
se7   <- sqrt(diag( vcovHC(reg7) ))
# se7  = sqrt(diag(  cluster.vcov(reg7, short.data.compust$type1) ) )

reg8 <- lm(success_of_stated_obj~ log_top20_w_sd_spr +exit_s_board+exit_s_proxy+ log_active.activist_sd_weight+log_active.activist_sd_weight*exit_s_board+log_active.activist_sd_weight*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb
           # +factor(holder_type)
           , data = short.data.compust)
se8   <- sqrt(diag( vcovHC(reg8) ))
# se8  = sqrt(diag(  cluster.vcov(reg8, short.data.compust$type1) ) )

ols3_output = capture.output(stargazer(reg1, reg2, reg3, reg4, reg5,reg6,reg7,reg8,
                                       type = "latex",  
                                       title = "OLS regressions with robust standard errors, clustered by campaign type. Each regression contains firm level controls.",
                                       font.size = "tiny", float.env="sidewaystable",header = FALSE,
                                       omit.stat=c("f", "ser"),
                                        report = "vct*",
                                       digits = 4,
                                        omit = c("holder_type", "age","log(size)", "leverage", "mtb"),
                                       # omit.labels = "Firm specific controls?",
                                       se=list(se1, se2,se3,se4,se5,
                                               se6,se7,se8 )))

# 
note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{14cm}{ \\textit{Notes:} }} \\\\"
ols3_output[grepl("Note",ols3_output)] <- note.latex
cat (ols3_output, sep = "\n")


reg1 <- glm(success_of_stated_obj ~ top20_number+exit_s_board+exit_s_proxy+log(active.activist.share)+ log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy +poison_pill+age+log(size)+leverage+mtb, data = short.data.compust, family = "binomial")
# se1   <- sqrt(diag(vcovHC(reg1) ))
se1  = sqrt(diag(  cluster.vcov(reg1, short.data.compust$type1) ) )

reg2 <- glm(success_of_stated_obj~ (log_act_num_con) +top20_number +exit_s_board+exit_s_proxy+log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust, family = "binomial")
se2   <- sqrt(diag( vcovHC(reg2) ))
# se2  = sqrt(diag(  cluster.vcov(reg2, short.data.compust$type1) ) )

reg3 <- glm(success_of_stated_obj~ log_top20_share_nw_s +exit_s_board+exit_s_proxy+log(active.activist.share)+log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust, family = "binomial")
se3   <- sqrt(diag( vcovHC(reg3) ))
# se3  = sqrt(diag(  cluster.vcov(reg3, short.data.compust$type1) ) )

reg4 <- glm(success_of_stated_obj~ log_top20_share_nw_spr +exit_s_board+exit_s_proxy+ log(active.activist.share)+log(active.activist.share)*exit_s_board+log(active.activist.share)*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust,
            family = "binomial")
se4   <- sqrt(diag( vcovHC(reg4) ))
# se4  = sqrt(diag(  cluster.vcov(reg4, short.data.compust$type1) ) )

reg5 <- glm(success_of_stated_obj~ log_top20_w_norm_s +exit_s_board+exit_s_proxy+log_active.activist_norm_weight+log_active.activist_norm_weight*exit_s_board+log_active.activist_norm_weight*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust, family = "binomial")
se5   <- sqrt(diag( vcovHC(reg5) ))
# se5  = sqrt(diag(  cluster.vcov(reg5, short.data.compust$type1) ) )

reg6 <- glm(success_of_stated_obj~ log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight+log_active.activist_norm_weight*exit_s_board+log_active.activist_norm_weight*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust, family = "binomial")
se6   <- sqrt(diag( vcovHC(reg6) ))
# se6  = sqrt(diag(  cluster.vcov(reg6, short.data.compust$type1) ) )


reg7 <- glm(success_of_stated_obj~ log_top20_w_sd_s+exit_s_board+exit_s_proxy+log_active.activist_sd_weight+log_active.activist_sd_weight*exit_s_board+log_active.activist_sd_weight*exit_s_proxy +poison_pill+age+log(size)+leverage+mtb, data = short.data.compust, family = "binomial")
se7   <- sqrt(diag( vcovHC(reg7) ))
# se7  = sqrt(diag(  cluster.vcov(reg7, short.data.compust$type1) ) )

reg8 <- glm(success_of_stated_obj~ log_top20_w_sd_spr +exit_s_board+exit_s_proxy+ log_active.activist_sd_weight+log_active.activist_sd_weight*exit_s_board+log_active.activist_sd_weight*exit_s_proxy+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust, family = "binomial")
se8   <- sqrt(diag( vcovHC(reg8) ))
# se8  = sqrt(diag(  cluster.vcov(reg8, short.data.compust$type1) ) )

ols3_output = capture.output(stargazer(reg1, reg2, reg3, reg4, reg5,reg6,reg7,reg8,
                                       type = "latex",  
                                       title = "OLS regressions with robust standard errors, clustered by campaign type",
                                       font.size = "tiny", float.env="sidewaystable",header = FALSE,
                                       omit.stat=c("f", "ser"),
                                        report = "vct*",
                                       digits = 4,
                                       se=list(se1, se2,se3,se4,se5,
                                               se6,se7,se8 )))

# 
note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{14cm}{ \\textit{Notes:}   }} \\\\"
ols3_output[grepl("Note",ols3_output)] <- note.latex
cat (ols3_output, sep = "\n")


#----------------------------------Run type 3 regressions - with centrality measures ---------------------------------



# Two closeness measures

ols3_binar_sic <- lm(won_board_ind ~ act_s_clos+oth_s_clos+log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight++poison_pill+age+log(size)+leverage+mtb+short_term, data = short.data.compust)
re_ols3_binar_sic   <- sqrt(diag( vcovHC(ols3_binar_sic) ))

ols3_binar_sibe <- lm(won_board_ind ~ act_s_betw+oth_s_betw+log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight++poison_pill+age+log(size)+leverage+mtb+short_term, data = short.data.compust)
re_ols3_binar_sibe   <- sqrt(diag( vcovHC(ols3_binar_sibe) ))

ols3_binar_sibo <- lm(won_board_ind ~ act_s_bon+oth_s_bon+log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight+poison_pill+age+log(size)+leverage+mtb, data = short.data.compust)
re_ols3_binar_sibo   <- sqrt(diag( vcovHC(ols3_binar_sibo) ))

ols3_binar_spc <- lm(won_board_ind ~ act_sp_clos+oth_sp_clos+log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight+poison_pill+age+log(size)+leverage+mtb+short_term, data = short.data.compust)
re_ols3_binar_spc   <- sqrt(diag( vcovHC(ols3_binar_spc) ))

ols3_binar_spbe <- lm(won_board_ind ~ act_sp_betw+oth_sp_betw+log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight+poison_pill+age+log(size)+leverage+mtb+short_term, data = short.data.compust)
re_ols3_binar_spbe  <- sqrt(diag( vcovHC(ols3_binar_spbe) ))

ols3_binar_sbo <- lm(won_board_ind ~ act_sp_bon+oth_sp_bon+log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight+poison_pill+age+log(size)+leverage+mtb+short_term, data = short.data.compust)
re_ols3_binar_sbe   <- sqrt(diag( vcovHC(ols3_binar_sbo) ))


ols3_classified_sic <- lm(success_of_stated_obj ~ oth_s_clos+log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight+poison_pill+age+log(size)+leverage+mtb+short_term, data = short.data.compust)
re_ols3_classified_sic   <- sqrt(diag( vcovHC(ols3_classified_sic) ))

ols3_classified_sibe <- lm(success_of_stated_obj ~ oth_s_betw+log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight+poison_pill+age+log(size)+leverage+mtb+short_term, data = short.data.compust)
re_ols3_classified_sibe   <- sqrt(diag( vcovHC(ols3_classified_sibe) ))

ols3_classified_spc <- lm(success_of_stated_obj ~ oth_sp_clos+log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight+poison_pill+age+log(size)+leverage+mtb+short_term, data = short.data.compust)
re_ols3_classified_spc   <- sqrt(diag( vcovHC(ols3_classified_spc) ))

ols3_classified_spbe <- lm(success_of_stated_obj ~ oth_sp_betw+log_top20_w_norm_spr +exit_s_board+exit_s_proxy+ log_active.activist_norm_weight+poison_pill+age+log(size)+leverage+mtb+short_term, data = short.data.compust)
re_ols3_classified_spbe  <- sqrt(diag( vcovHC(ols3_classified_spbe) ))


out_centr = capture.output( stargazer(
                                        # ols3_binar_sic,ols3_binar_sibe,ols3_binar_sibo,
                                       # ols3_binar_spc, ols3_binar_spbe, ols3_binar_sbo,
                                       ols3_classified_sic, ols3_classified_sibe, 
                                       ols3_classified_spc, ols3_classified_spbe,
          type = "latex",  title = " OLS regressions with centrality measures, robust se", header = FALSE,
           report = "vct*", digits = 4,
          omit.stat=c("f", "ser"), font.size = "tiny", float.env="sidewaystable",
          se=list(
            # re_ols3_binar_sic,re_ols3_binar_sibe,re_ols3_binar_sibo,
                  # re_ols3_binar_spc,re_ols3_binar_spbe,re_ols3_binar_sbe,
                  re_ols3_classified_sic,re_ols3_classified_sibe, 
                  re_ols3_classified_spc,re_ols3_classified_spbe)
          ))


# note.latex <- "\\multicolumn{9}{l} {\\parbox[t]{12cm}{\\footnotesize \\textit{Notes:} OLS regression  of the equation $Y = \\alpha + \\beta x + \\gamma \\bar{x} +controls+\\epsilon$.The regressions are run using the centrality measures to proxy for persuasiveness of an activist. Centrality is a characteristic of a node that captures the importance of the node position in a network. I use three centrality measures for this analysis. Closeness centrality shows how close each node to any other node. Betweennes centrality captures how well situated a node is in terms of the paths that it lies on. Degree centrality, is defined a the number of links incident to a node. Bonacich centrality is a degree centrality adjusted for the centrality of the neighbours in a network. The centrality measures were computed for both Simple and Spring networks. (By construction, centrality measures for Simple network are identical to the centrality measures of Number of Connections network.) After that I aggregated the centrality measures for each campaign. That is, $act\\_simple\\_closeness$ is a sum of closeness centralities of every active activist participating in a campaign, and $oth\\_simple\\_closeness$ is a sum of closeness centralities of every passive activist that invested in the company but does not participate in a campaign. 
# Robust standard errors in parenthesis. }} \\\\"
# out_centr[grepl("Note",out_centr)] <- note.latex
cat (out_centr, sep = "\n")




```